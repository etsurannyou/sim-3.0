(()=>{"use strict";const t=t=>document.querySelector(t),s=t=>document.createElement(t),e=(t,s,e)=>t.addEventListener(s,(()=>e()));function i(t,s){for(let e=0;e<t.length;e++)if(s===t[e])return e;return-1}function a(t=0){return new Promise((s=>setTimeout(s,t)))}function h(t){const s=String(t).split("e"),e=Number(s[1])+Math.log10(Math.max(1,Number(s[0])));return Number(e)}function o(t,s=3){const e=Math.floor(t),i=t-e,a=l(Math.pow(10,i),s);return(a>=10?a/10:a)+"e"+(a>=10?e+1:e)}function r(t,s=5){return t>=1e6?o(Math.log10(t),3):l(t,s-Math.floor(Math.log10(Math.abs(t))))}function l(t,s){return Math.round(t*Math.pow(10,s))/Math.pow(10,s)}function n(t,s){const e=t>s?t:s,i=t>s?s:t,a=Math.floor(e),h=Math.pow(10,e-a),o=Math.floor(i),r=Math.pow(10,i-o);return a+Math.log10(h+r/Math.pow(10,a-o))}function u(t,s){const e=t>s?t:s,i=t>s?s:t,a=Math.floor(e),h=Math.pow(10,e-a),o=Math.floor(i),r=Math.pow(10,i-o);return a+Math.log10(h-r/Math.pow(10,a-o))}function c(t,s){let e=new Array(t).fill(s),i=[];if(!Array.isArray(s))return e;for(let t=0;t<e.length;t++)e[0][0].constructor===Array&&e[0][0][0].constructor===Array?i.push(...e[t]):i.push(e[t]);return i}function v(t){return Math.log10(t)}const m=Math.random()+1e-9;function d(t,s){return[t.theory,t.sigma,o(t.lastPub,2),o(t.pubRho,2),o(t.pubRho-t.lastPub,2),r(t.pubMulti),t.strat+s,r(t.maxTauH),(e=Math.max(0,t.pubT-t.recovery.time),`${Math.floor(e/86400)}d${Math.floor(e/3600%24)}h${Math.floor(e/60%60)}m`),[t.pubRho,t.recovery.recoveryTime?t.recovery.time:Math.max(0,t.pubT-t.recovery.time)]];var e}const p=JSON.parse('{"Jp":["T1","T2","T3","T4","T5","T6","T7","T8","WSP","SL","EF","CSR2","PD","FI"],"S3":[["T1","T1C34","T1C4","T1Ratio","T1SolarXLII"],["T2","T2mc","T2ms","T2qs"],["T3","T3C11C12C21","T3noC11C13C21C33","T3noC13C32C33","T3noC13C33","T3noP1C13C33","T3Snax","T3Snax2","T3C11C12C21d","T3noC11C13C21C33d","T3noC11C13C33d","T3noC13C32C33d","T3noC13C33d","T3Play","T3Play2"],["T4","T4C12","T4C3","T4C4","T4C5","T4C56","T4C12d","T4C123d","T4C4d","T4C5d","T4C56d","T4C3dC12rcv","T4C3d66"],["T5","T5Idle","T5AI","T5AI2"],["T6","T6C3","T6C4","T6noC1234","T6noC34","T6noC345","T6C3d","T6C4d","T6noC1234d","T6noC34d","T6noC345d","T6snax","T6AI"],["T7","T7C12","T7noC12","T7noC123","T7noC124","T7noC1234","T7C12d","T7C3d","T7Play25","T7PlaySpqcey"],["T8","T8d","T8noC35","T8noC3","T8noC5","T8noC3d","T8noC5d","T8noC35d","T8Play","T8PlaySolarswap"],["WSP","WSPStopC1","WSPdStopC1"],["SL","SLStopA","SLStopAd","SLMS","SLMSd"],["EF","EFd","EFsnax","EFAI"],["CSR2","CSR2d","CSR2XL"],["PD","PDnoA","PDnoAB","PDnoABC","PDnoAD","PDnoAd","PDnoABd","PDnoABCd","PDnoADd","PDAI"],["GF"]],"Sw":["All","Single sim","Chain","Steps","Amount","Time","Time diff."],"xy":["","","","Step length: ","Amount of pubs (Chain): ","Total Time: "],"CN":["<sigma> <t1>* [t2]* ... [wsp]* ... [csr2]* \\n\\n*[r/t/m] = rho/tau/total multiplier | default tau","","","","<Number>","<Hours>","<t1> [t1], ... , <t8> [t8] or <wsp> [wsp], ... , <csr2> [csr2]","<t1> [t1], ... , <t8> [t8] or <wsp> [wsp], ... , <csr2> [csr2]","<sigma 1> <sigma 2> [ct y/n] [idle strats only y/n]"]}');class b{constructor(t){var s,e,i,a;this.lvl=null!==(s=t.lvl)&&void 0!==s?s:0,this.cost=f(String(t.cost)),this.costInc=Math.log10(t.costInc),this.value="number"==typeof t.value||"string"==typeof t.value?f(String(t.value)):0,this.stepwisePowerSum=!0===(null===(e=t.stepwisePowerSum)||void 0===e?void 0:e.default)?{base:2,length:10}:"number"==typeof(null===(i=t.stepwisePowerSum)||void 0===i?void 0:i.base)&&"number"==typeof(null===(a=t.stepwisePowerSum)||void 0===a?void 0:a.length)?{base:t.stepwisePowerSum.base,length:t.stepwisePowerSum.length}:{base:0,length:0},this.varBase=t.varBase?Math.log10(t.varBase):1}buy(){this.cost+=this.costInc,0!==this.stepwisePowerSum.base?this.value=this.value===m?Math.log10(this.stepwisePowerSum.base)*Math.floor(this.lvl/this.stepwisePowerSum.length):n(this.value,Math.log10(this.stepwisePowerSum.base)*Math.floor(this.lvl/this.stepwisePowerSum.length)):this.value=this.varBase*(this.lvl+1),this.lvl++}}function f(t){if("Infinity"===t)throw"Variable value reached Infinity";return"0"===t?m:/[e]/.test(t)?h(t):Math.log10(Number(t))}var T=function(t,s,e,i){return new(e||(e=Promise))((function(a,h){function o(t){try{l(i.next(t))}catch(t){h(t)}}function r(t){try{l(i.throw(t))}catch(t){h(t)}}function l(t){var s;t.done?a(t.value):(s=t.value,s instanceof e?s:new e((function(t){t(s)}))).then(o,r)}l((i=i.apply(t,s||[])).next())}))};class M{constructor(t){var s;this.stratIndex=i(t.strats,t.strat),this.strat=t.strat,this.theory="T1",this.cap="number"==typeof t.cap&&t.cap>0?[t.cap,1]:[1/0,0],this.recovery=null!==(s=t.recovery)&&void 0!==s?s:{value:0,time:0,recoveryTime:!1},this.lastPub=t.rho,this.sigma=t.sigma,this.totMult=this.getTotMult(t.rho),this.curMult=0,this.dt=P.dt,this.ddt=P.ddt,this.t=0,this.ticks=0,this.rho=0,this.maxRho=0,this.variables=[new b({lvl:1,cost:5,costInc:2,value:1,stepwisePowerSum:{default:!0}}),new b({cost:100,costInc:10,varBase:2}),new b({cost:15,costInc:2,stepwisePowerSum:{default:!0}}),new b({cost:3e3,costInc:10,varBase:2}),new b({cost:1e4,costInc:Math.pow(2,4.5*Math.log2(10)),varBase:10}),new b({cost:1e10,costInc:Math.pow(2,8*Math.log2(10)),varBase:10})],this.term1=0,this.term2=0,this.term3=0,this.termRatio=0,this.c3Ratio=this.lastPub<300?1:this.lastPub<450?1.1:this.lastPub<550?2:this.lastPub<655?5:10,this.tauH=0,this.maxTauH=0,this.pubT=0,this.pubRho=0,this.milestones=[0,0,0,0],this.result=[],this.pubMulti=0,this.conditions=this.getBuyingConditions(),this.milestoneConditions=this.getMilestoneConditions(),this.milestoneTree=this.getMilestoneTree(),this.updateMilestones()}getBuyingConditions(){let t=[[...c(6,!0)],[!0,!0,!1,!1,!0,!0],[!0,!0,!1,!1,!1,!0],[()=>this.variables[0].cost+1<this.rho,()=>this.variables[1].cost+v(1.11)<this.rho,()=>this.variables[2].cost+this.termRatio+1<=this.rho,()=>this.variables[3].cost+this.termRatio<=this.rho,()=>this.variables[4].cost+v(this.c3Ratio)<this.rho,!0],[()=>this.variables[0].cost+v(5)<=this.rho&&this.variables[0].cost+v(6+this.variables[0].lvl%10)<=this.variables[1].cost&&this.variables[0].cost+v(15+this.variables[0].lvl%10)<(this.milestones[3]>0?this.variables[5].cost:1e3),()=>this.variables[1].cost+v(1.11)<this.rho,()=>this.variables[2].cost+this.termRatio+1<=this.rho,()=>this.variables[3].cost+this.termRatio<=this.rho,()=>this.variables[4].cost+v(this.c3Ratio)<this.rho,!0]];return t=t.map((t=>t.map((t=>"function"==typeof t?t:()=>t)))),t}getMilestoneConditions(){return[()=>!0,()=>!0,()=>!0,()=>!0,()=>this.milestones[2]>0,()=>this.milestones[3]>0]}getMilestoneTree(){return[...new Array(5).fill([[0,0,0,0],[0,0,1,0],[0,0,1,1],[1,0,1,1],[1,1,1,1],[1,2,1,1],[1,3,1,1]])]}getTotMult(t){return Math.max(0,.164*t-v(3))+v(Math.pow(this.sigma/20,this.sigma<65?0:this.sigma<75?1:this.sigma<85?2:3))}updateMilestones(){const t=Math.min(6,Math.floor(Math.max(this.lastPub,this.maxRho)/25));this.milestones=this.milestoneTree[this.stratIndex][Math.min(this.milestoneTree[this.stratIndex].length-1,t)]}simulate(){return T(this,void 0,void 0,(function*(){let t=8*Math.ceil((this.lastPub-10)/8)+10,s=t-this.lastPub<3?t+2:t-this.lastPub<5?t-2+Math.log10(1.5):t-4+Math.log10(1.4),e=(t-this.lastPub<3?t:Math.floor(this.lastPub))+Math.log10(30);e=Math.max(8+Math.log10(30),e+Math.floor(s-e));let i=!1;for(;!i&&P.simulating;)(this.ticks+1)%5e5==0&&(yield a()),this.tick(),this.rho>this.maxRho&&(this.maxRho=this.rho),this.lastPub<176&&this.updateMilestones(),this.curMult=Math.pow(10,this.getTotMult(this.maxRho)-this.totMult),(4!==this.stratIndex||this.rho<e||P.forcedPubTime!==1/0)&&this.buyVariables(),i=(P.forcedPubTime!==1/0?this.t>P.forcedPubTime:4===this.stratIndex?this.pubRho>s:this.t>2*this.pubT||this.pubRho>this.cap[0])&&this.pubRho>10,this.ticks++;return this.pubMulti=Math.pow(10,this.getTotMult(this.pubRho)-this.totMult),this.result=d(this,P.forcedPubTime===1/0&&4===this.stratIndex?` ${this.lastPub<50?"":o(Math.min(this.pubRho,e),2)}`:""),this.result}))}tick(){this.term1=this.variables[2].value*(1+.05*this.milestones[1])+this.variables[3].value+(this.milestones[0]>0?v(1+this.rho/Math.LOG10E/100):0),this.term2=n(this.variables[4].value+.2*this.rho,this.variables[5].value+.3*this.rho),this.term3=this.variables[0].value+this.variables[1].value;let t=n(this.term1,this.term2)+this.term3+this.totMult+v(this.dt);this.rho=n(this.rho,t),this.t+=this.dt/1.5,this.dt*=this.ddt,this.maxRho<this.recovery.value&&(this.recovery.time=this.t),this.tauH=(this.maxRho-this.lastPub)/(this.t/3600),(this.maxTauH<this.tauH||this.maxRho>=this.cap[0]-this.cap[1]||this.pubRho<10||P.forcedPubTime!==1/0||4===this.stratIndex)&&(this.maxTauH=this.tauH,this.pubT=this.t,this.pubRho=this.maxRho)}buyVariables(){let t=!1;for(let s=this.variables.length-1;s>=0;s--)for(;this.rho>this.variables[s].cost&&this.conditions[this.stratIndex][s]()&&this.milestoneConditions[s]();)this.rho=u(this.rho,this.variables[s].cost),this.variables[s].buy(),t=!0;t&&(this.termRatio=Math.max(v(5),(this.term2-this.term1)*Number(this.milestones[3]>0)))}}var g=function(t,s,e,i){return new(e||(e=Promise))((function(a,h){function o(t){try{l(i.next(t))}catch(t){h(t)}}function r(t){try{l(i.throw(t))}catch(t){h(t)}}function l(t){var s;t.done?a(t.value):(s=t.value,s instanceof e?s:new e((function(t){t(s)}))).then(o,r)}l((i=i.apply(t,s||[])).next())}))};class y{constructor(t){var s;this.stratIndex=i(t.strats,t.strat),this.strat=t.strat,this.theory="T2",this.cap="number"==typeof t.cap&&t.cap>0?[t.cap,1]:[1/0,0],this.recovery=null!==(s=t.recovery)&&void 0!==s?s:{value:0,time:0,recoveryTime:!1},this.lastPub=t.rho,this.sigma=t.sigma,this.totMult=this.getTotMult(t.rho),this.curMult=0,this.dt=P.dt,this.ddt=P.ddt,this.t=0,this.ticks=0,this.rho=0,this.maxRho=0,this.q1=0,this.q2=0,this.q3=0,this.q4=0,this.r1=0,this.r2=0,this.r3=0,this.r4=0,this.variables=[new b({lvl:1,cost:10,costInc:2,value:1,stepwisePowerSum:{default:!0}}),new b({cost:5e3,costInc:2,stepwisePowerSum:{default:!0}}),new b({cost:3e25,costInc:3,stepwisePowerSum:{default:!0}}),new b({cost:8e50,costInc:4,stepwisePowerSum:{default:!0}}),new b({cost:2e6,costInc:2,stepwisePowerSum:{default:!0}}),new b({cost:3e9,costInc:2,stepwisePowerSum:{default:!0}}),new b({cost:4e25,costInc:3,stepwisePowerSum:{default:!0}}),new b({cost:5e50,costInc:4,stepwisePowerSum:{default:!0}})],this.tauH=0,this.maxTauH=0,this.pubT=0,this.pubRho=0,this.milestones=[0,0,0,0],this.result=[],this.pubMulti=0,this.conditions=this.getBuyingConditions(),this.milestoneConditions=this.getMilestoneConditions(),this.milestoneTree=this.getMilestoneTree(),this.updateMilestones()}getBuyingConditions(){let t=[new Array(8).fill(!0),[()=>this.curMult<4650,()=>this.curMult<2900,()=>this.curMult<2250,()=>this.curMult<1150,()=>this.curMult<4650,()=>this.curMult<2900,()=>this.curMult<2250,()=>this.curMult<1150],new Array(8).fill(!0),new Array(8).fill(!0)];return t=t.map((t=>t.map((t=>"function"==typeof t?t:()=>t)))),t}getMilestoneConditions(){return[()=>!0,()=>!0,()=>this.milestones[0]>0,()=>this.milestones[0]>1,()=>!0,()=>!0,()=>this.milestones[1]>0,()=>this.milestones[1]>1]}getMilestoneTree(){return[...new Array(4).fill([[0,0,0,0],[1,0,0,0],[2,0,0,0],[2,1,0,0],[2,2,0,0],[2,2,1,0],[2,2,2,0],[2,2,3,0],[2,2,3,1],[2,2,3,2],[2,2,3,3]])]}getTotMult(t){return Math.max(0,.198*t-v(100))+v(Math.pow(this.sigma/20,this.sigma<65?0:this.sigma<75?1:this.sigma<85?2:3))}updateMilestones(){let t=Math.min(10,Math.floor(Math.max(this.lastPub,this.maxRho)/25));this.milestones=[0,0,0,0];let s=[];if(this.stratIndex<2&&(s=[1,2,3,4]),2===this.stratIndex){let t=this.t%100;t<10?s=[3,4,1,2]:t<50?s=[1,2,3,4]:t<60?s=[3,4,1,2]:t<100&&(s=[2,1,3,4])}if(3===this.stratIndex){let t=1/0;this.lastPub>0&&(t=10),this.lastPub>75&&(t=200),this.lastPub>100&&(t=200),this.lastPub>125&&(t=200),this.lastPub>150&&(t=600),this.lastPub>200&&(t=100),this.lastPub>225&&(t=25),s=this.curMult<t?[1,2,3,4]:[3,4,1,2]}const e=[2,2,3,3];for(let i=0;i<s.length;i++)for(;this.milestones[s[i]-1]<e[s[i]-1]&&t>0;)this.milestones[s[i]-1]++,t--}simulate(){return g(this,void 0,void 0,(function*(){let t=!1;for(;!t&&P.simulating;)(this.ticks+1)%5e5==0&&(yield a()),this.tick(),this.rho>this.maxRho&&(this.maxRho=this.rho),this.lastPub<250&&this.updateMilestones(),this.curMult=Math.pow(10,this.getTotMult(this.maxRho)-this.totMult),this.buyVariables(),t=(P.forcedPubTime!==1/0?this.t>P.forcedPubTime:this.t>2*this.pubT||this.pubRho>this.cap[0])&&this.pubRho>15,this.ticks++;return this.pubMulti=Math.pow(10,this.getTotMult(this.pubRho)-this.totMult),this.result=d(this,""),this.result}))}tick(){let t=v(this.dt);this.q1=n(this.q1,this.variables[0].value+this.q2+t),this.q2=n(this.q2,this.variables[1].value+this.q3+t),this.q3=this.milestones[0]>0?n(this.q3,this.variables[2].value+this.q4+t):this.q3,this.q4=this.milestones[0]>1?n(this.q4,this.variables[3].value+t):this.q4,this.r1=n(this.r1,this.variables[4].value+this.r2+t),this.r2=n(this.r2,this.variables[5].value+this.r3+t),this.r3=this.milestones[1]>0?n(this.r3,this.variables[6].value+this.r4+t):this.r3,this.r4=this.milestones[1]>1?n(this.r4,this.variables[7].value+t):this.r4;let s=this.q1*(1+.05*this.milestones[2])+this.r1*(1+.05*this.milestones[3])+this.totMult+t;this.rho=n(this.rho,s),this.t+=this.dt/1.5,this.dt*=this.ddt,this.maxRho<this.recovery.value&&(this.recovery.time=this.t),this.tauH=(this.maxRho-this.lastPub)/(this.t/3600),(this.maxTauH<this.tauH||this.maxRho>=this.cap[0]-this.cap[1]||this.pubRho<15||P.forcedPubTime!==1/0)&&(this.maxTauH=this.tauH,this.pubT=this.t,this.pubRho=this.maxRho)}buyVariables(){for(let t=this.variables.length-1;t>=0;t--)for(;this.rho>this.variables[t].cost&&this.conditions[this.stratIndex][t]()&&this.milestoneConditions[t]();)this.rho=u(this.rho,this.variables[t].cost),this.variables[t].buy()}}var w=function(t,s,e,i){return new(e||(e=Promise))((function(a,h){function o(t){try{l(i.next(t))}catch(t){h(t)}}function r(t){try{l(i.throw(t))}catch(t){h(t)}}function l(t){var s;t.done?a(t.value):(s=t.value,s instanceof e?s:new e((function(t){t(s)}))).then(o,r)}l((i=i.apply(t,s||[])).next())}))};class x{constructor(t){var s;this.stratIndex=i(t.strats,t.strat),this.strat=t.strat,this.theory="T3",this.cap="number"==typeof t.cap&&t.cap>0?[t.cap,1]:[1/0,0],this.recovery=null!==(s=t.recovery)&&void 0!==s?s:{value:0,time:0,recoveryTime:!1},this.lastPub=t.rho,this.sigma=t.sigma,this.totMult=this.getTotMult(t.rho),this.curMult=0,this.dt=P.dt,this.ddt=P.ddt,this.t=0,this.ticks=0,this.currencies=[0,0,0],this.maxRho=0,this.variables=[new b({lvl:1,cost:10,costInc:1.18099,value:1,stepwisePowerSum:{default:!0}}),new b({cost:10,costInc:1.308,stepwisePowerSum:{default:!0}}),new b({cost:3e3,costInc:1.675,stepwisePowerSum:{default:!0}}),new b({cost:20,costInc:6.3496,varBase:2}),new b({cost:10,costInc:2.74,varBase:2}),new b({cost:1e3,costInc:1.965,varBase:2}),new b({cost:500,costInc:18.8343,varBase:2}),new b({cost:1e5,costInc:3.65,varBase:2}),new b({cost:1e5,costInc:2.27,varBase:2}),new b({cost:1e4,costInc:1248.27,varBase:2}),new b({cost:1e3,costInc:6.81744,varBase:2}),new b({cost:1e5,costInc:2.98,varBase:2})],this.tauH=0,this.maxTauH=0,this.pubT=0,this.pubRho=0,this.milestones=[0,0,0,0],this.result=[],this.pubMulti=0,this.conditions=this.getBuyingConditions(),this.milestoneConditions=this.getMilestoneConditions(),this.milestoneTree=this.getMilestoneTree(),this.updateMilestones()}getBuyingConditions(){let t=[new Array(12).fill(!0),[!0,!0,!1,!0,!0,!1,!0,!1,!1,!1,!1,!1],[!0,!0,!0,!1,!0,!1,!1,!0,!0,!0,!0,!1],[!0,!0,!0,!0,!0,!1,!0,!0,!0,!0,!1,!1],[!0,!0,!0,!0,!0,!1,!0,!0,!0,!0,!0,!1],[!1,!0,!0,!1,!0,!1,!1,!0,!0,!1,!0,!1],[()=>this.curMult<1,!0,!0,!1,()=>!(this.curMult<1)||this.variables[4].cost+2<this.currencies[0],!1,!1,!0,!0,()=>this.curMult<1,()=>this.curMult<1,()=>this.curMult<1],[()=>this.curMult<1&&this.variables[0].cost+1<this.currencies[0],()=>this.variables[1].cost+v(3)<this.currencies[1],()=>this.variables[2].cost+v(5)<this.currencies[2],!1,()=>!(this.curMult<1)||this.variables[4].cost+2<this.currencies[0],!1,!1,()=>this.curMult<1||this.variables[7].cost+v(8)<this.currencies[1],!0,()=>this.curMult<1,()=>this.curMult<1,()=>this.curMult<1&&this.variables[11].cost+1<this.currencies[2]],[()=>this.variables[0].cost+v(7)<Math.min(this.variables[3].cost,this.variables[6].cost),()=>this.variables[1].cost+v(7)<this.variables[4].cost,!1,!0,!0,!1,!0,!1,!1,!1,!1,!1],[()=>this.variables[0].cost+v(8)<this.variables[9].cost,()=>this.variables[1].cost+v(5)<Math.min(this.variables[4].cost,this.variables[7].cost,this.variables[10].cost),()=>this.variables[2].cost+v(8)<this.variables[8].cost,!1,!0,!1,!1,!0,!0,!0,!0,!1],[()=>this.variables[0].cost+v(10)<Math.min(this.variables[6].cost,this.variables[9].cost),()=>this.variables[1].cost+v(4)<Math.min(this.variables[4].cost,this.variables[7].cost,this.variables[10].cost),()=>this.variables[2].cost+v(10)<this.variables[8].cost,!1,!0,!1,!0,!0,!0,!0,!0,!1],[()=>this.variables[0].cost+v(8)<Math.min(this.variables[3].cost,this.variables[6].cost,this.variables[9].cost),()=>this.variables[1].cost+v(5)<Math.min(this.variables[4].cost,this.variables[7].cost),()=>this.variables[2].cost+v(8)<this.variables[8].cost,!0,!0,!1,!0,!0,!0,!0,!1,!1],[()=>this.variables[0].cost+v(10)<Math.min(this.variables[3].cost,this.variables[6].cost,this.variables[9].cost),()=>this.variables[1].cost+v(4)<Math.min(this.variables[4].cost,this.variables[7].cost,this.variables[10].cost),()=>this.variables[2].cost+v(10)<this.variables[8].cost,!0,!0,!1,!0,!0,!0,!0,!0,!1],[()=>this.curMult<2&&this.variables[0].cost+v(8)<this.variables[9].cost,()=>!(this.curMult<2)||this.variables[1].cost+v(4)<Math.min(this.variables[4].cost,this.variables[10].cost)&&this.variables[1].cost+v(2)<this.variables[7].cost,()=>this.variables[2].cost+v(8)<this.variables[8].cost&&this.variables[2].cost+v(2)<this.variables[11].cost,!1,!0,!1,!1,()=>!(this.curMult<2)||this.variables[7].cost+v(2)<Math.min(this.variables[4].cost,this.variables[10].cost),!0,()=>this.curMult<2,!0,()=>this.variables[11].cost+v(4)<this.variables[8].cost],[()=>this.lastPub-this.maxRho>1&&this.variables[0].cost+v(8)<this.variables[9].cost,()=>(this.curMult<1.2?this.variables[1].cost+v(5)<this.variables[10].cost:this.variables[1].cost+v(8)<this.variables[4].cost)||this.curMult>2.4,()=>!(this.curMult<2.4)||this.variables[2].cost+v(8)<this.variables[8].cost,!1,()=>!(this.curMult<1.2)||this.variables[4].cost+2<this.variables[10].cost,!1,!1,()=>this.curMult<1.2?this.variables[7].cost+v(2.5)<this.variables[10].cost:this.variables[7].cost+v(8)<this.variables[4].cost,!0,()=>this.lastPub-this.maxRho>1,()=>this.curMult<1.2||this.curMult<2.4&&this.variables[10].cost+v(8)<this.variables[4].cost,()=>this.curMult<1.2&&this.variables[11].cost+v(10)<this.variables[8].cost]];return t=t.map((t=>t.map((t=>"function"==typeof t?t:()=>t)))),t}getMilestoneConditions(){return[()=>!0,()=>!0,()=>this.milestones[0]>0,()=>!0,()=>!0,()=>this.milestones[0]>0,()=>!0,()=>!0,()=>this.milestones[0]>0,()=>this.milestones[0]>0,()=>this.milestones[0]>0,()=>this.milestones[0]>0]}getMilestoneTree(){return[...new Array(15).fill([[0,0,0,0],[0,1,0,0],[0,2,0,0],[0,2,1,0],[0,2,2,0],[1,2,2,0],[1,2,2,1],[1,2,2,2]])]}getTotMult(t){return Math.max(0,.147*t+v(3))+v(Math.pow(this.sigma/20,this.sigma<65?0:this.sigma<75?1:this.sigma<85?2:3))}updateMilestones(){const t=Math.min(7,Math.floor(Math.max(this.lastPub,this.maxRho)/25));this.milestones=this.milestoneTree[this.stratIndex][Math.min(this.milestoneTree[this.stratIndex].length-1,t)]}simulate(){return w(this,void 0,void 0,(function*(){let t=!1;for(;!t&&P.simulating;)(this.ticks+1)%5e5==0&&(yield a()),this.tick(),this.currencies[0]>this.maxRho&&(this.maxRho=this.currencies[0]),this.lastPub<175&&this.updateMilestones(),this.curMult=Math.pow(10,this.getTotMult(this.maxRho)-this.totMult),this.buyVariables(),t=(P.forcedPubTime!==1/0?this.t>P.forcedPubTime:this.t>2*this.pubT||this.pubRho>this.cap[0])&&this.pubRho>9,this.ticks++;return this.pubMulti=Math.pow(10,this.getTotMult(this.pubRho)-this.totMult),this.result=d(this,""),this.result}))}tick(){let t=this.variables[0].value*(1+.05*this.milestones[1]),s=this.variables[1].value*(1+.05*this.milestones[2]),e=this.variables[2].value*(1+.05*this.milestones[3]),i=n(n(this.variables[3].value+t,this.variables[4].value+s),this.variables[5].value+e);this.currencies[0]=n(this.currencies[0],v(this.dt)+this.totMult+i);let a=n(n(this.variables[6].value+t,this.variables[7].value+s),this.variables[8].value+e);this.currencies[1]=n(this.currencies[1],v(this.dt)+this.totMult+a);let h=n(n(this.variables[9].value+t,this.variables[10].value+s),this.variables[11].value+e);this.currencies[2]=this.milestones[0]>0?n(this.currencies[2],v(this.dt)+this.totMult+h):0,this.t+=this.dt/1.5,this.dt*=this.ddt,this.maxRho<this.recovery.value&&(this.recovery.time=this.t),this.tauH=(this.maxRho-this.lastPub)/(this.t/3600),(this.maxTauH<this.tauH||this.maxRho>=this.cap[0]-this.cap[1]||this.pubRho<9||P.forcedPubTime!==1/0)&&(this.maxTauH=this.tauH,this.pubT=this.t,this.pubRho=this.maxRho)}buyVariables(){for(let t=this.variables.length-1;t>=0;t--){let s=t%3;for(;this.currencies[s]>this.variables[t].cost&&this.conditions[this.stratIndex][t]()&&this.milestoneConditions[t]();)this.currencies[s]=u(this.currencies[s],this.variables[t].cost),this.variables[t].buy()}}}var I=function(t,s,e,i){return new(e||(e=Promise))((function(a,h){function o(t){try{l(i.next(t))}catch(t){h(t)}}function r(t){try{l(i.throw(t))}catch(t){h(t)}}function l(t){var s;t.done?a(t.value):(s=t.value,s instanceof e?s:new e((function(t){t(s)}))).then(o,r)}l((i=i.apply(t,s||[])).next())}))};class C{constructor(t){var s;this.stratIndex=i(t.strats,t.strat),this.strat=t.strat,this.theory="T4",this.cap="number"==typeof t.cap&&t.cap>0?[t.cap,2]:[1/0,0],this.recovery=null!==(s=t.recovery)&&void 0!==s?s:{value:0,time:0,recoveryTime:!1},this.recursionValue=t.recursionValue,this.lastPub=t.rho,this.sigma=t.sigma,this.totMult=this.getTotMult(t.rho),this.curMult=0,this.dt=P.dt,this.ddt=P.ddt,this.t=0,this.ticks=0,this.rho=0,this.maxRho=0,this.q=0,this.variables=[new b({lvl:1,cost:5,costInc:1.305,value:1,stepwisePowerSum:{default:!0}}),new b({cost:20,costInc:3.75,varBase:2}),new b({cost:2e3,costInc:2.468,varBase:2}),new b({cost:1e4,costInc:4.85,varBase:3}),new b({cost:1e8,costInc:12.5,varBase:5}),new b({cost:1e10,costInc:58,varBase:10}),new b({cost:1e3,costInc:100,stepwisePowerSum:{default:!0}}),new b({cost:1e4,costInc:1e3,varBase:2})],this.variableSum=0,this.tauH=0,this.maxTauH=0,this.pubT=0,this.pubRho=0,this.milestones=[0,0,0],this.result=[],this.pubMulti=0,this.conditions=this.getBuyingConditions(),this.milestoneConditions=this.getMilestoneConditions(),this.milestoneTree=this.getMilestoneTree(),this.updateMilestones()}getBuyingConditions(){let t=[[...c(8,!0)],[!0,!0,...c(6,!1)],[!1,!1,!0,...c(3,!1),!0,!0],[...c(3,!1),!0,!1,!1,!0,!0],[...c(4,!1),!0,!1,!0,!0],[...c(4,!1),!0,!0,!0,!0],[()=>this.variables[0].cost+1<this.variables[1].cost,!0,!1,!1,!1,!1,!1,!1],[()=>this.variables[0].cost+1<Math.min(this.variables[1].cost),!0,!0,!1,!1,!1,()=>this.variables[6].cost+1<this.variables[7].cost,!0],[!1,!1,!1,!0,!1,!1,()=>this.variables[6].cost+1<this.variables[7].cost,!0],[...c(4,!1),!0,!1,()=>this.variables[6].cost+1<this.variables[7].cost,!0],[...c(4,!1),!0,!0,()=>this.variables[6].cost+1<this.variables[7].cost,!0],[()=>this.variables[0].cost+1<this.variables[1].cost&&this.curMult<1,()=>this.curMult<1,!0,...c(3,!1),()=>this.variables[6].cost+1<this.variables[7].cost,!0],[!1,!1,()=>{var t;return this.variables[2].cost+.1<(null!==(t=this.recursionValue)&&void 0!==t?t:1/0)},...c(3,!1),()=>{var t;return this.variables[6].cost+v(10+this.variables[6].lvl%10)<=Math.min(this.variables[7].cost,this.variables[2].cost)&&this.variables[6].cost+v(10+this.variables[6].lvl%10)+1<(null!==(t=this.recursionValue)&&void 0!==t?t:1/0)},()=>{var t;return this.variables[7].cost+.5<(null!==(t=this.recursionValue)&&void 0!==t?t:1/0)&&(this.curMult<1||this.variables[7].cost+v(1.5)<=this.variables[2].cost)}]];return t=t.map((t=>t.map((t=>"function"==typeof t?t:()=>t)))),t}getMilestoneConditions(){return[()=>!0,()=>!0,()=>!0,()=>this.milestones[0]>0,()=>this.milestones[0]>1,()=>this.milestones[0]>2,()=>!0,()=>!0]}getMilestoneTree(){return[[[0,0,0],[1,0,0],[2,0,0],[3,0,0],[3,0,1],[3,0,2],[3,0,3],[3,1,3]],[[0,0,0],[0,1,0]],[[0,0,0],[0,0,1],[0,0,2],[0,0,3]],[[0,0,0],[1,0,0],[1,0,1],[1,0,2],[1,0,3]],[[0,0,0],[1,0,0],[2,0,0],[2,0,1],[2,0,2],[2,0,3]],[[0,0,0],[1,0,0],[2,0,0],[3,0,0],[3,0,1],[3,0,2],[3,0,3],[3,0,3]],[[0,0,0],[0,1,0]],[[0,0,0],[0,1,0],[0,1,1],[0,1,2],[0,1,3]],[[0,0,0],[1,0,0],[1,0,1],[1,0,2],[1,0,3]],[[0,0,0],[1,0,0],[2,0,0],[2,0,1],[2,0,2],[2,0,3]],[[0,0,0],[1,0,0],[2,0,0],[3,0,0],[3,0,1],[3,0,2],[3,0,3],[3,0,3]],[[0,0,0],[0,1,0],[0,1,1],[0,1,2],[0,1,3]],[[0,0,0],[0,0,1],[0,0,2],[0,0,3]]]}getTotMult(t){return Math.max(0,.165*t-v(4))+v(Math.pow(this.sigma/20,this.sigma<65?0:this.sigma<75?1:this.sigma<85?2:3))}updateMilestones(){const t=Math.min(7,Math.floor(Math.max(this.lastPub,this.maxRho)/25));this.milestones=this.milestoneTree[this.stratIndex][Math.min(this.milestoneTree[this.stratIndex].length-1,t)]}simulate(t){return I(this,void 0,void 0,(function*(){if(null==this.recursionValue&&"T4C3d66"===this.strat&&P.forcedPubTime===1/0){t.recursionValue=Number.MAX_VALUE;let s=yield new C(t).simulate(t);this.recursionValue=s[9][0]}let s=!1;for(;!s&&P.simulating;)(this.ticks+1)%5e5==0&&(yield a()),this.tick(),this.rho>this.maxRho&&(this.maxRho=this.rho),this.lastPub<176&&this.updateMilestones(),this.curMult=Math.pow(10,this.getTotMult(this.maxRho)-this.totMult),this.buyVariables(),s=P.forcedPubTime!==1/0?this.t>P.forcedPubTime:(this.t>2*this.pubT||this.pubRho>this.cap[0])&&this.pubRho>9,this.ticks++;return this.pubMulti=Math.pow(10,this.getTotMult(this.pubRho)-this.totMult),this.result=d(this,12===this.stratIndex?` q1: ${this.variables[6].lvl} q2: ${this.variables[7].lvl}`:""),this.result}))}tick(){let t=this.variables[6].value,s=this.variables[7].value,e=v(2)*this.milestones[2]+t+s-n(0,this.q);this.q=n(this.q,e+v(this.dt));let i=this.totMult+this.variableSum;this.rho=n(this.rho,i+v(this.dt)),this.t+=this.dt/1.5,this.dt*=12===this.stratIndex&&this.recursionValue===Number.MAX_VALUE?10*this.ddt:this.ddt,this.maxRho<this.recovery.value&&(this.recovery.time=this.t),this.tauH=(this.maxRho-this.lastPub)/(this.t/3600),(this.maxTauH<this.tauH||this.maxRho>=this.cap[0]-this.cap[1]||this.pubRho<9||P.forcedPubTime!==1/0)&&(this.maxTauH=this.tauH,this.pubT=this.t,this.pubRho=this.maxRho)}buyVariables(){let t=!1;for(let s=this.variables.length-1;s>=0;s--)for(;this.rho>this.variables[s].cost&&this.conditions[this.stratIndex][s]()&&this.milestoneConditions[s]();)this.rho=u(this.rho,this.variables[s].cost),this.variables[s].buy(),t=!0;let s=this.variables[0].value*(1+.15*this.milestones[1]),e=this.variables[1].value;this.variableSum=s+e,this.variables[2].lvl>0&&(this.variableSum=n(this.variableSum,this.variables[2].value+this.q)),this.variables[3].lvl>0&&(this.variableSum=n(this.variableSum,this.variables[3].value+2*this.q)),this.variables[4].lvl>0&&(this.variableSum=n(this.variableSum,this.variables[4].value+3*this.q)),this.variables[5].lvl>0&&(this.variableSum=n(this.variableSum,this.variables[5].value+4*this.q))}}var S=function(t,s,e,i){return new(e||(e=Promise))((function(a,h){function o(t){try{l(i.next(t))}catch(t){h(t)}}function r(t){try{l(i.throw(t))}catch(t){h(t)}}function l(t){var s;t.done?a(t.value):(s=t.value,s instanceof e?s:new e((function(t){t(s)}))).then(o,r)}l((i=i.apply(t,s||[])).next())}))};const B=t(".output"),P={dt:1.5,ddt:1.0001,stratFilter:!0,simulating:!1,forcedPubTime:1/0},R={lastStrat:null,simEndTimestamp:0};function A(t){return S(this,void 0,void 0,(function*(){if(-1!==i(["Best Overall","Best Active","Best Semi-Idle","Best Idle"],t.strat))return function(t){return S(this,void 0,void 0,(function*(){const s=function(t,s,e){let i=[];switch(t){case"T1":i=[s<25,"Best Overall"!==e&&"Best Active"!==e&&s>=25&&s<850,"Best Overall"!==e&&"Best Active"!==e&&s>625,"Best Semi-Idle"!==e&&"Best Idle"!==e&&("Best Active"===e||s<250),"Best Semi-Idle"!==e&&"Best Idle"!==e&&"Best Active"!==e];break;case"T2":i=["Best Semi-Idle"!==e&&"Best Active"!==e&&"Best Overall"!==e||s<25,"Best Idle"!==e&&("Best Active"!==e&&"Best Overall"!==e||s>=250),"Best Semi-Idle"!==e&&"Best Idle"!==e&&s<250,"Best Active"!==e&&"Best Overall"!==e&&"Best Idle"!==e&&s<250];break;case"T3":i=[s<25,"Best Overall"!==e&&"Best Active"!==e&&s<150,"Best Overall"!==e&&"Best Active"!==e&&"Best Semi-Idle"!==e&&s>=175&&s<300,"Best Overall"!==e&&"Best Active"!==e&&s>=100&&s<175,"Best Overall"!==e&&"Best Active"!==e&&"Best Semi-Idle"!==e&&s>=175&&s<300,"Best Overall"!==e&&"Best Active"!==e&&s>=260&&(s<500||"Best Semi-Idle"!==e),"Best Overall"!==e&&"Best Active"!==e&&"Best Idle"!==e&&s>=150,"Best Overall"!==e&&"Best Idle"!==e&&"Best Semi-Idle"!==e&&s>=275,"Best Semi-Idle"!==e&&"Best Idle"!==e&&s<150,"Best Semi-Idle"!==e&&"Best Idle"!==e&&s>=150&&s<350,"Best Semi-Idle"!==e&&"Best Idle"!==e&&s>=150&&s<350,"Best Semi-Idle"!==e&&"Best Idle"!==e&&s>=150&&s<175,"Best Semi-Idle"!==e&&"Best Idle"!==e&&s>=150&&s<225,"Best Semi-Idle"!==e&&"Best Idle"!==e&&"Best Active"!==e&&s>=200&&s<375,"Best Semi-Idle"!==e&&"Best Idle"!==e&&"Best Active"!==e&&s>=250];break;case"T4":i=[s<30,"Best Overall"!==e&&"Best Active"!==e&&s<600&&("T4C12"===R.lastStrat||null===R.lastStrat||s<225),"Best Overall"!==e&&"Best Active"!==e&&s>200,"Best Overall"!==e&&"Best Active"!==e&&s<125,"Best Overall"!==e&&"Best Active"!==e&&s<150,"Best Overall"!==e&&"Best Active"!==e&&s<275,"Best Semi-Idle"!==e&&"Best Idle"!==e&&s<700&&("T4C12d"===R.lastStrat||null===R.lastStrat||s<225),"Best Semi-Idle"!==e&&"Best Idle"!==e&&s<700&&s>175&&("T4C3d66"!==R.lastStrat||s<225),"Best Semi-Idle"!==e&&"Best Idle"!==e&&s<125,"Best Semi-Idle"!==e&&"Best Idle"!==e&&s<150,"Best Semi-Idle"!==e&&"Best Idle"!==e&&s<275,"Best Semi-Idle"!==e&&"Best Idle"!==e&&s<700&&("T4C3d66"!==R.lastStrat||s<300),"Best Semi-Idle"!==e&&"Best Idle"!==e&&s>225];break;case"T5":case"T6":case"T7":case"T8":case"WSP":case"SL":case"EF":case"CSR2":case"PD":case"FI":case"BP":i=[]}let a=[];switch(t){case"T1":a=[!0,s>=25,s>=50,!0,!0];break;case"T2":a=[!0,!0,!0,!0];break;case"T3":a=[!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0];break;case"T4":a=[!0,!0,!0,s>=25,s>=50,s>=50,!0,!0,s>=25,s>=50,s>=50,!0,!0];break;case"T5":case"T6":case"T7":case"T8":case"WSP":case"SL":case"EF":case"CSR2":case"PD":case"FI":case"BP":a=[]}if(0===i.length)throw"No strats found";let h=[];for(let s=0;s<i.length;s++)!i[s]&&P.stratFilter||!a[s]||h.push(p.S3[D(t)][s]);return h}(t.theory,t.rho,t.strat);let e=new Array(9).fill(0);for(let i=0;i<s.length;i++){t.strat=s[i];let a=yield A(t);e[7]<a[7]&&(e=a)}return e}))}(t);const s={strat:t.strat,strats:p.S3[D(t.theory)],sigma:t.sigma,rho:t.rho,recursionValue:null,recovery:t.recovery,cap:t.hardCap?t.cap:null};switch(t.theory){case"T1":return yield function(t){return T(this,void 0,void 0,(function*(){let s=new M(t);return yield s.simulate()}))}(s);case"T2":return yield function(t){return g(this,void 0,void 0,(function*(){let s=new y(t);return yield s.simulate()}))}(s);case"T3":return yield function(t){return w(this,void 0,void 0,(function*(){let s=new x(t);return yield s.simulate()}))}(s);case"T4":return yield function(t){return I(this,void 0,void 0,(function*(){let s=new C(t);return yield s.simulate(t)}))}(s)}throw"Unknown error in singleSim() function. Please contact the author of the sim."}))}function H(t,s,e,i="r"){if("string"==typeof t){const s=t.charAt(t.length-1);if(null!==s.match(/[r/t/m]/))L(t=t.slice(0,-1))&&(t=[t,s]);else{if(!s.match(/[0-9]/))throw`Invalid currency value ${t}. Currency value must be in formats <number>, <exxxx> or <xexxxx>.`;L(t)&&(t=[t,i])}}if("string"==typeof t[0]&&Array.isArray(t)&&(t[0]=k(t[0])),"number"!=typeof t[0])throw`Cannot parse value ${t[0]}. Please contact the author of the sim.`;if("r"===t[1])return t[0];if("t"===t[1])return t[0]/function(t){switch(t){case"T1":case"T2":case"T3":case"T4":case"T5":case"T6":case"T7":case"T8":return 1;case"WSP":case"SL":case"CSR2":case"FI":case"PD":return.1;case"BP":return.15;case"EF":return.4}throw`Invalid theory ${t}. Please contact the author of the sim.`}(s);if("m"===t[1])return function(t,s,e){let i=()=>e<65?0:e<75?1:e<85?2:3,a=(t,a)=>(s-Math.log10(Math.pow(e/20,i()))+Math.log10(a))*(1/t),h=t=>(s-Math.log10(Math.pow(e/20,i())))*(1/t);switch(t){case"T1":return a(.164,3);case"T2":return a(.198,100);case"T3":return o=.147,r=3,(s-Math.log10(Math.pow(e/20,i()))-Math.log10(r))*(1/o);case"T4":return a(.165,4);case"T5":return h(.159);case"T6":return a(.196,50);case"T7":return h(.152);case"T8":return h(.15);case"WSP":case"SL":return s/.15;case"EF":return s*(1/.387)*2.5;case"CSR2":return(s+Math.log10(200))*(1/2.203)*10}var o,r;throw"Failed parsing multiplier. Please contact the author of the sim."}(s,t[0],e);throw`Cannot parse value ${t[0]} and ${t[1]}. Please contact the author of the sim.`}function L(t){if(null===t.match(/^[0-9/e/.]+$/))throw`Invalid currency value ${t}. Currency value must be in formats <number>, <exxxx> or <xexxxx>.`;let s=0;for(let e=0;e<t.length;e++)"e"===t[e]&&s++;if(s>1)throw`Invalid currency value ${t}. Currency value must be in formats <number>, <exxxx> or <xexxxx>.`;let e=0;for(let s=0;s<t.length;s++)"."===t[s]&&e++;if(e>1)throw`Invalid currency value ${t}. Currency value must be in formats <number>, <exxxx> or <xexxxx>.`;return!0}function D(t){return i(p.Jp,t)}function k(t){return/[e]/.test(t)?h(t):parseFloat(t)}const q=t(".theory"),O=t(".strat"),F=(t(".sigma"),t(".input"),t(".cap")),V=t(".mode"),E=t("textarea"),$=t(".hardCap"),W=t(".extraInputs"),N=t(".timeDiffWrapper"),J=(".controls",document.querySelectorAll(".controls"))[0];const X=t(".simAllInputs"),z=t(".extraInputDescription");for(let t=0;t<p.Jp.length;t++){const e=s("option");e.value=p.Jp[t],e.textContent=p.Jp[t],q.appendChild(e)}for(let t=0;t<p.S3[0].length;t++){const e=s("option");e.value=p.S3[0][t],e.textContent=p.S3[0][t],O.appendChild(e)}for(let t=0;t<p.Sw.length&&V.children.length!==p.Sw.length;t++){const e=s("option");e.value=p.Sw[t],e.textContent=p.Sw[t],V.appendChild(e)}function U(){J.style.display="none",W.style.display="none",N.style.display="none",$.style.display="none",X.style.display="none",z.style.display="inline",E.style.height="1.8em",E.style.width="6rem",F.style.display="inline","Single sim"!==V.value&&"Time diff."!==V.value&&"Chain"!==V.value&&(W.style.display="flex"),"Time diff."===V.value&&(N.style.display="grid"),"All"!==V.value&&"Time diff."!==V.value&&(J.style.display="grid"),"Chain"===V.value&&($.style.display="block"),"All"===V.value&&(X.style.display="inline-flex",z.style.display="none",E.style.height="3rem",E.style.width="20rem"),E.placeholder=p.CN[i(p.Sw,V.value)],z.textContent=p.xy[i(p.Sw,V.value)]}U(),e(V,"input",U),e(q,"change",(function(){for(;O.firstChild;)O.firstChild.remove();const t=["Best Overall","Best Active","Best Semi-Idle","Best Idle"];for(let e=0;e<4;e++){const i=s("option");i.value=t[e],i.textContent=t[e],O.appendChild(i)}const e=i(p.Jp,q.value);for(let t=0;t<p.S3[e].length;t++){const i=s("option");i.value=p.S3[e][t],i.textContent=p.S3[e][t],O.appendChild(i)}}));const G=t(".theory"),_=t(".strat"),j=t(".sigma"),K=t(".input"),Q=t(".cap"),Y=t(".mode"),Z=t("textarea"),tt=t(".hardCap"),st=t(".output"),et=t("table"),it=t(".dtOtp"),at=t(".ddtOtp");const ht=t(".theory"),ot=t(".strat"),rt=t(".sigma"),lt=t(".input"),nt=t(".cap"),ut=t(".mode"),ct=t("textarea"),vt=t(".hardCap"),mt=t(".output");let dt=t("table"),pt=t("thead"),bt=t("tbody");const ft=t(".simulate"),Tt=t(".dtOtp"),Mt=t(".ddtOtp"),gt='<th style="padding-inline: 0.5rem !important">Theory</th><th><b style="font-size: 1rem">&sigma;</b><sub>t</sub></th><th>Last Pub</th><th>Max Rho</th><th>&Delta;<i style="font-size:1rem">&tau;</i></th><th>Multi</th><th>Strat</th><th><i style="font-size:1rem">&tau;</i>/h</th><th>Pub Time</th>',yt="<th>&emsp;</th><th>Input</th><th>&tau;/h Active</th><th>&tau;/h Idle</th><th>Ratio</th><th>Multi Active</th><th>Multi Idle</th><th>Strat Active</th><th>Strat Idle</th><th>Time Active</th><th>Time Idle</th><th>&Delta;&tau; Active</th><th>&Delta;&tau; Idle</th>";pt.innerHTML=yt,dt.classList.add("big"),e(ft,"click",(()=>{return e=void 0,i=void 0,r=function*(){var e,i;P.dt=parseFloat(null!==(e=Tt.textContent)&&void 0!==e?e:"1.5"),P.ddt=parseFloat(null!==(i=Mt.textContent)&&void 0!==i?i:"1.0001"),P.stratFilter=!0;const h={theory:ht.value,strat:ot.value,sigma:rt.value,rho:lt.value,cap:nt.value,mode:ut.value,modeInput:ct.value,hardCap:vt.checked};mt.textContent="",ft.textContent="Stop simulating",yield a();let r=yield function(t){return S(this,void 0,void 0,(function*(){if(P.simulating)return P.simulating=!1,"Sim stopped.";if((performance.now()-R.simEndTimestamp)/1e3<1)return null;try{let s,e=function(t){const s={theory:t.theory,strat:t.strat,mode:t.mode,hardCap:t.hardCap,modeInput:t.modeInput,sigma:0,rho:0,cap:1/0,recovery:null};if("All"!==t.mode&&"Time diff."!==t.mode){if(!(t.sigma.length>0&&null!==t.sigma.match(/^[0-9]+$/)&&parseInt(t.sigma)>=0&&parseFloat(t.sigma)%1==0))throw"Invalid sigma value. Sigma must be an integer that's >= 0";if(s.sigma=parseInt(t.sigma),!(t.rho.length>0))throw"Input value cannot be empty.";if(s.rho=H(t.rho,s.theory,s.sigma),"Chain"===t.mode||"Steps"===t.mode){if(!(t.cap.length>0))throw"Cap value cannot be empty.";s.cap=H(t.cap,s.theory,s.sigma)}}return"Single sim"!==t.mode&&"Chain"!==t.mode&&(s.modeInput=function(t,s){if("Steps"===s&&"string"==typeof t&&L(t))return k(t);if(("Time"===s||"Amount"===s)&&"string"==typeof t){if(null!==t.match(/[0-9]/))return parseFloat(t);throw s+" input must be a number."}if("Time diff."===s||"All"===s||"Single sim"===s||"Chain"===s)return t;throw`Couldnt parse mode ${s}. Please contact the author of the sim.`}(t.modeInput,t.mode)),s}(t);return P.simulating=!0,s="Single sim"===e.mode?[yield A(e)]:yield function(t){return S(this,void 0,void 0,(function*(){let s=t.rho,e=0;const i=[];let h=o(t.cap),r=0;for(;s<t.cap&&P.simulating;){let l=performance.now();l-r>100&&(r=l,B.textContent=`Simulating ${o(s,0)}/${h}`,yield a());let n=yield A(Object.assign({},t));i.push(n),s=n[n.length-1][0],t.rho=s,e+=n[n.length-1][1]}return i}))}(e),R.simEndTimestamp=performance.now(),s}catch(t){return String(t)}}))}(h);mt.textContent="string"==typeof r?r:"",null!==r&&"string"!=typeof r&&function(e){dt=t("table"),pt=t("thead"),bt=t("tbody"),e[0].length!==pt.children[0].children.length&&10===e[0].length&&(pt.innerHTML=gt,dt.classList.remove("big"),dt.classList.add("small"),function(){for(;bt.firstChild;)bt.firstChild.remove()}());for(let t=0;t<e.length;t++){const i=s("tr");for(let a=0;a<pt.children[0].children.length;a++){const h=s("td");h.innerText=String(e[t][a]),i.appendChild(h)}bt.appendChild(i)}}(r),ft.textContent="Simulate",P.simulating=!1,localStorage.setItem("simState",JSON.stringify({controls1:{theory:{value:G.value,innerHTML:G.innerHTML},strat:{value:_.value,innerHTML:_.innerHTML},sigma:j.value,input:K.value,cap:Q.value},controls2:{mode:Y.value,modeInput:Z.value,extraInputDescription:t(".extraInputDescription").textContent,hardCap:tt.checked,timeDiffInputs:[t(".timeDiffWrapper").children[0].value,t(".timeDiffWrapper").children[1].value,t(".timeDiffWrapper").children[2].value]},output:st.textContent,table:et.innerHTML,settings:{dt:it.textContent,ddt:at.textContent}}))},new((h=void 0)||(h=Promise))((function(t,s){function a(t){try{l(r.next(t))}catch(t){s(t)}}function o(t){try{l(r.throw(t))}catch(t){s(t)}}function l(s){var e;s.done?t(s.value):(e=s.value,e instanceof h?e:new h((function(t){t(e)}))).then(a,o)}l((r=r.apply(e,i||[])).next())}));var e,i,h,r})),setTimeout((()=>function(){var s;const e=JSON.parse(null!==(s=localStorage.getItem("simState"))&&void 0!==s?s:'{"controls1":{"theory":{"value":"T1","innerHTML":"<option value=\\"T1\\">T1</option><option value=\\"T2\\">T2</option><option value=\\"T3\\">T3</option><option value=\\"T4\\">T4</option><option value=\\"T5\\">T5</option><option value=\\"T6\\">T6</option><option value=\\"T7\\">T7</option><option value=\\"T8\\">T8</option><option value=\\"WSP\\">WSP</option><option value=\\"SL\\">SL</option><option value=\\"EF\\">EF</option><option value=\\"CSR2\\">CSR2</option><option value=\\"PD\\">PD</option><option value=\\"FI\\">FI</option>"},"strat":{"value":"Best Overall","innerHTML":"\\n            <option value=\\"Best Overall\\">Best Overall</option>\\n            <option value=\\"Best Active\\">Best Active</option>\\n            <option value=\\"Best Semi-Idle\\">Best Semi-Idle</option>\\n            <option value=\\"Best Idle\\">Best Idle</option>\\n          <option value=\\"T1\\">T1</option><option value=\\"T1C34\\">T1C34</option><option value=\\"T1C4\\">T1C4</option><option value=\\"T1Ratio\\">T1Ratio</option><option value=\\"T1SolarXLII\\">T1SolarXLII</option>"},"sigma":"","input":"","cap":false},"controls2":{"mode":"All","modeInput":"","extraInputDescription":"","hardCap":"on","timeDiffInputs":["","",""]},"output":"","table":"\\n<thead><tr><th> </th><th>Input</th><th>τ/h Active</th><th>τ/h Idle</th><th>Ratio</th><th>Multi Active</th><th>Multi Idle</th><th>Strat Active</th><th>Strat Idle</th><th>Time Active</th><th>Time Idle</th><th>Δτ Active</th><th>Δτ Idle</th></tr></thead>\\n        <tbody></tbody>\\n      ","settings":{"dt":"1.5","ddt":"1.0001"}}');G.innerHTML=e.controls1.theory.innerHTML,G.value=e.controls1.theory.value,_.innerHTML=e.controls1.strat.innerHTML,_.value=e.controls1.strat.value,j.value=e.controls1.sigma,K.value=e.controls1.input,Q.value=e.controls1.cap,Y.value=e.controls2.mode,Z.value=e.controls2.modeInput,t(".extraInputDescription").textContent=e.controls2.extraInputDescription,tt.checked=e.controls2.hardCap,t(".timeDiffWrapper").children[0].value=e.controls2.timeDiffInputs[0],t(".timeDiffWrapper").children[1].value=e.controls2.timeDiffInputs[1],t(".timeDiffWrapper").children[2].value=e.controls2.timeDiffInputs[2],st.textContent=e.output,et.innerHTML=e.table,it.textContent=e.settings.dt,at.textContent=e.settings.ddt,t(".dt").value="8.1943",t(".ddt").value="2.71233",U(),et.classList.remove("big"),et.classList.remove("small"),"All"!==e.controls2.mode?et.classList.add("small"):et.classList.add("big")}()),500)})();