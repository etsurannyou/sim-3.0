(()=>{"use strict";const t=JSON.parse('{"Jp":["T1","T2","T3","T4","T5","T6","T7","T8","WSP","SL","EF","CSR2","RZ","FP"],"S3":[["T1","T1C34","T1C4","T1Ratio","T1SolarXLII"],["T2","T2mc","T2ms","T2qs"],["T3","T3C11C12C21","T3noC11C13C21C33","T3noC13C32C33","T3noC13C33","T3noP1C13C33","T3Snax","T3Snax2","T3C11C12C21d","T3noC11C13C21C33d","T3noC11C13C33d","T3noC13C32C33d","T3noC13C33d","T3Play","T3Play2"],["T4","T4C12","T4C3","T4C4","T4C5","T4C56","T4C12d","T4C123d","T4C456dC12rcvMS","T4C356dC12rcv","T4C56d","T4C3d66"],["T5","T5Idle","T5AI2"],["T6","T6C3","T6C4","T6noC34","T6noC345","T6noC1234","T6snax","T6C3d","T6C4d","T6noC34d","T6noC345d","T6noC1234d","T6AI"],["T7","T7C12","T7C3","T7noC12","T7noC123","T7noC1234","T7C12d","T7C3d","T7PlaySpqcey"],["T8","T8noC3","T8noC5","T8noC35","T8snax","T8noC3d","T8noC5d","T8noC35d","T8d","T8Play","T8PlaySolarswap"],["WSP","WSPStopC1","WSPdStopC1"],["SL","SLStopA","SLStopAd","SLMS","SLMSd"],["EF","EFsnax","EFd","EFAI"],["CSR2","CSR2d","CSR2XL"],["RZ","RZd","RZdBH","RZSpiralswap","RZMS","RZnoB"],["FP"]],"Sw":["All","Single sim","Chain","Steps","Amount","Time","Time diff."],"xy":["","","","Step length: ","Amount of pubs (Chain): ","Total Time: "],"CN":["<sigma> <t1>* [t2]* ... [wsp]* ... [csr2]* \\n\\n*[r/t/m] = rho/tau/total multiplier | default tau","","","","<Number>","<Hours>","<t1> [t1], ... , <t8> [t8] or <wsp> [wsp], ... , <csr2> [csr2]","<t1> [t1], ... , <t8> [t8] or <wsp> [wsp], ... , <csr2> [csr2]","<sigma 1> <sigma 2> [ct y/n] [idle strats only y/n]"]}'),s=t=>document.querySelector(t),i=t=>document.querySelectorAll(t),e=t=>document.createElement(t),h=(t,s,i)=>t.addEventListener(s,(t=>i(t)));function a(t,s){for(let i=0;i<t.length;i++)if(s===t[i])return i;return-1}function o(t=0){return new Promise((s=>setTimeout(s,t)))}function l(s){return a(t.Jp,s)}function r(t){switch(t){case"T1":case"T2":case"T3":case"T4":case"T5":case"T6":case"T7":case"T8":return 1;case"WSP":case"SL":case"CSR2":case"RZ":return.1;case"EF":return.4;case"FP":return.075}throw`Invalid theory ${t}. Please contact the author of the sim.`}function n(s){return t.Jp[s]}function u(t){const s=String(t).split("e"),i=Number(s[1])+Math.log10(Math.max(1,Number(s[0])));return Number(i)}function c(t,s=3){const i=Math.floor(t),e=t-i,h=(a=Math.pow(10,e),o=s,Math.round(a*Math.pow(10,o))/Math.pow(10,o));var a,o;return(h>=10?h/10:h)+"e"+(h>=10?i+1:i)}function v(t){let s=Math.floor(t/60%60),i=Math.floor(t/3600%24),e=Math.floor(t/86400%365),h=Math.floor(t/31536e3),a="";return h>0&&(a+=h<1e6?h:c(Math.log10(h)),a+="y"),e>0&&(a+=e+"d"),a+=(i<10?"0":"")+i+"h",0===h&&(a+=(s<10?"0":"")+s+"m"),a}function m(t,s=6){return t.toPrecision(s).replace(/[+]/,"")}function b(t,s){const i=t>s?t:s,e=t>s?s:t,h=Math.floor(i),a=Math.pow(10,i-h),o=Math.floor(e),l=Math.pow(10,e-o);return h+Math.log10(a+l/Math.pow(10,h-o))}function d(t,s){const i=t>s?t:s,e=t>s?s:t,h=Math.floor(i),a=Math.pow(10,i-h),o=Math.floor(e),l=Math.pow(10,e-o);return h+Math.log10(a-l/Math.pow(10,h-o))}function p(t){return Math.log10(t)}const f=(()=>{let t=Math.random();for(;0===t;)t=Math.random();return t})();function M(t,s){return[t.theory,t.sigma,c(t.lastPub,2),c(t.pubRho,2),c((t.pubRho-t.lastPub)*r(t.theory),2),m(t.pubMulti),t.strat+s,0===t.maxTauH?0:Number(m(t.maxTauH*r(t.theory))),v(Math.max(0,t.pubT-t.recovery.time)),[t.pubRho,t.recovery.recoveryTime?t.recovery.time:Math.max(0,t.pubT-t.recovery.time)]]}class g{constructor(t){var s,i,e,h;this.lvl=null!==(s=t.lvl)&&void 0!==s?s:0,this.costData=t.cost,this.cost=this.costData.getCost(this.lvl),this.value="number"==typeof t.value||"string"==typeof t.value?w(String(t.value)):0,this.stepwisePowerSum=!0===(null===(i=t.stepwisePowerSum)||void 0===i?void 0:i.default)?{base:2,length:10}:"number"==typeof(null===(e=t.stepwisePowerSum)||void 0===e?void 0:e.base)&&"number"==typeof(null===(h=t.stepwisePowerSum)||void 0===h?void 0:h.length)?{base:t.stepwisePowerSum.base,length:t.stepwisePowerSum.length}:{base:0,length:0},this.varBase=t.varBase?t.varBase:10,this.firstFreeCost=!0===t.firstFreeCost?1:0,t.firstFreeCost&&this.buy()}buy(){0!==this.stepwisePowerSum.base?this.value=this.value===f?Math.log10(this.stepwisePowerSum.base)*Math.floor(this.lvl/this.stepwisePowerSum.length):b(this.value,Math.log10(this.stepwisePowerSum.base)*Math.floor(this.lvl/this.stepwisePowerSum.length)):this.value=Math.log10(this.varBase)*(this.lvl+1),this.lvl++,this.cost=this.costData.getCost(this.lvl-this.firstFreeCost)}reCalculate(){if(0!==this.stepwisePowerSum.base){let t=Math.floor(this.lvl/this.stepwisePowerSum.length),s=this.lvl-t*this.stepwisePowerSum.length,i=this.stepwisePowerSum.length/(this.stepwisePowerSum.base-1);this.value=d(Math.log10(i+s)+Math.log10(this.stepwisePowerSum.base)*t,Math.log10(i))}else this.value=Math.log10(this.varBase)*this.lvl}}function w(t){if("Infinity"===t)throw"Variable value reached Infinity";return"0"===t?f:/[e]/.test(t)?u(t):Math.log10(Number(t))}class T{constructor(t,s,i=!1){this.cost=w(String(t)),this.costInc=w(String(s)),i&&(this.costInc=Math.log10(2)*Math.pow(10,this.costInc))}getCost(t){return this.cost+this.costInc*t}}var y=function(t,s,i,e){return new(i||(i=Promise))((function(h,a){function o(t){try{r(e.next(t))}catch(t){a(t)}}function l(t){try{r(e.throw(t))}catch(t){a(t)}}function r(t){var s;t.done?h(t.value):(s=t.value,s instanceof i?s:new i((function(t){t(s)}))).then(o,l)}r((e=e.apply(t,s||[])).next())}))};class x{constructor(t){var s;this.stratIndex=a(t.strats,t.strat),this.strat=t.strat,this.theory="T1",this.cap="number"==typeof t.cap&&t.cap>0?[t.cap,1]:[1/0,0],this.recovery=null!==(s=t.recovery)&&void 0!==s?s:{value:0,time:0,recoveryTime:!1},this.lastPub=t.rho,this.sigma=t.sigma,this.totMult=this.getTotMult(t.rho),this.curMult=0,this.dt=tt.dt,this.ddt=tt.ddt,this.t=0,this.ticks=0,this.rho=0,this.maxRho=0,this.variables=[new g({cost:new T(5,2),stepwisePowerSum:{default:!0},firstFreeCost:!0}),new g({cost:new T(100,10),varBase:2}),new g({cost:new T(15,2),stepwisePowerSum:{default:!0}}),new g({cost:new T(3e3,10),varBase:2}),new g({cost:new T(1e4,4.5*Math.log2(10),!0),varBase:10}),new g({cost:new T(1e10,8*Math.log2(10),!0),varBase:10})],this.term1=0,this.term2=0,this.term3=0,this.termRatio=0,this.c3Ratio=this.lastPub<300?1:this.lastPub<450?1.1:this.lastPub<550?2:this.lastPub<655?5:10,this.boughtVars=[],this.tauH=0,this.maxTauH=0,this.pubT=0,this.pubRho=0,this.milestones=[0,0,0,0],this.pubMulti=0,this.conditions=this.getBuyingConditions(),this.milestoneConditions=this.getMilestoneConditions(),this.milestoneTree=this.getMilestoneTree(),this.updateMilestones()}getBuyingConditions(){let t=[[...new Array(6).fill(!0)],[!0,!0,!1,!1,!0,!0],[!0,!0,!1,!1,!1,!0],[()=>this.variables[0].cost+1<this.rho,()=>this.variables[1].cost+p(1.11)<this.rho,()=>this.variables[2].cost+this.termRatio+1<=this.rho,()=>this.variables[3].cost+this.termRatio<=this.rho,()=>this.variables[4].cost+p(this.c3Ratio)<this.rho,!0],[()=>this.variables[0].cost+p(5)<=this.rho&&this.variables[0].cost+p(6+this.variables[0].lvl%10)<=this.variables[1].cost&&this.variables[0].cost+p(15+this.variables[0].lvl%10)<(this.milestones[3]>0?this.variables[5].cost:1e3),()=>this.variables[1].cost+p(1.11)<this.rho,()=>this.variables[2].cost+this.termRatio+1<=this.rho,()=>this.variables[3].cost+this.termRatio<=this.rho,()=>this.variables[4].cost+p(this.c3Ratio)<this.rho,!0]];return t=t.map((t=>t.map((t=>"function"==typeof t?t:()=>t)))),t}getMilestoneConditions(){return[()=>!0,()=>!0,()=>!0,()=>!0,()=>this.milestones[2]>0,()=>this.milestones[3]>0]}getMilestoneTree(){return[...new Array(5).fill([[0,0,0,0],[0,0,1,0],[0,0,1,1],[1,0,1,1],[1,1,1,1],[1,2,1,1],[1,3,1,1]])]}getTotMult(t){return Math.max(0,.164*t-p(3))+p(Math.pow(this.sigma/20,this.sigma<65?0:this.sigma<75?1:this.sigma<85?2:3))}updateMilestones(){const t=Math.min(6,Math.floor(Math.max(this.lastPub,this.maxRho)/25));this.milestones=this.milestoneTree[this.stratIndex][Math.min(this.milestoneTree[this.stratIndex].length-1,t)]}simulate(){return y(this,void 0,void 0,(function*(){let t=8*Math.ceil((this.lastPub-10)/8)+10,s=t-this.lastPub<3?t+2:t-this.lastPub<5?t-2+Math.log10(1.5):t-4+Math.log10(1.4),i=(t-this.lastPub<3?t:Math.floor(this.lastPub))+Math.log10(30);i=Math.max(8+Math.log10(30),i+Math.floor(s-i));let e=!1;for(;!e&&tt.simulating;)(this.ticks+1)%5e5==0&&(yield o()),this.tick(),this.rho>this.maxRho&&(this.maxRho=this.rho),this.lastPub<176&&this.updateMilestones(),this.curMult=Math.pow(10,this.getTotMult(this.maxRho)-this.totMult),(4!==this.stratIndex||this.rho<i||tt.forcedPubTime!==1/0)&&this.buyVariables(),e=(tt.forcedPubTime!==1/0?this.t>tt.forcedPubTime:4===this.stratIndex?this.pubRho>s:this.t>2*this.pubT||this.pubRho>this.cap[0])&&this.pubRho>10,this.ticks++;this.pubMulti=Math.pow(10,this.getTotMult(this.pubRho)-this.totMult);let h=M(this,tt.forcedPubTime===1/0&&4===this.stratIndex?` ${this.lastPub<50?"":c(Math.min(this.pubRho,i),2)}`:"");for(;this.boughtVars[this.boughtVars.length-1].timeStamp>this.pubT;)this.boughtVars.pop();return tt.varBuy.push([h[7],this.boughtVars]),h}))}tick(){this.term1=this.variables[2].value*(1+.05*this.milestones[1])+this.variables[3].value+(this.milestones[0]>0?p(1+this.rho/Math.LOG10E/100):0),this.term2=b(this.variables[4].value+.2*this.rho,this.variables[5].value+.3*this.rho),this.term3=this.variables[0].value+this.variables[1].value;let t=b(this.term1,this.term2)+this.term3+this.totMult+p(this.dt);this.rho=b(this.rho,t),this.t+=this.dt/1.5,this.dt*=this.ddt,this.maxRho<this.recovery.value&&(this.recovery.time=this.t),this.tauH=(this.maxRho-this.lastPub)/(this.t/3600),(this.maxTauH<this.tauH||this.maxRho>=this.cap[0]-this.cap[1]||this.pubRho<10||tt.forcedPubTime!==1/0||4===this.stratIndex)&&(this.maxTauH=this.tauH,this.pubT=this.t,this.pubRho=this.maxRho)}buyVariables(){let t=!1;for(let s=this.variables.length-1;s>=0;s--)for(;this.rho>this.variables[s].cost&&this.conditions[this.stratIndex][s]()&&this.milestoneConditions[s]();){if(this.maxRho+5>this.lastPub&&(2!==s&&3!==s||this.lastPub<350)){let t=["q1","q2","c1","c2","c3","c4"];this.boughtVars.push({variable:t[s],level:this.variables[s].lvl+1,cost:this.variables[s].cost,timeStamp:this.t})}this.rho=d(this.rho,this.variables[s].cost),this.variables[s].buy(),t=!0}t&&(this.termRatio=Math.max(p(5),(this.term2-this.term1)*Number(this.milestones[3]>0)))}}var C=function(t,s,i,e){return new(i||(i=Promise))((function(h,a){function o(t){try{r(e.next(t))}catch(t){a(t)}}function l(t){try{r(e.throw(t))}catch(t){a(t)}}function r(t){var s;t.done?h(t.value):(s=t.value,s instanceof i?s:new i((function(t){t(s)}))).then(o,l)}r((e=e.apply(t,s||[])).next())}))};class B{constructor(t){var s;this.stratIndex=a(t.strats,t.strat),this.strat=t.strat,this.theory="T2",this.cap="number"==typeof t.cap&&t.cap>0?[t.cap,1]:[1/0,0],this.recovery=null!==(s=t.recovery)&&void 0!==s?s:{value:0,time:0,recoveryTime:!1},this.lastPub=t.rho,this.sigma=t.sigma,this.totMult=this.getTotMult(t.rho),this.curMult=0,this.dt=tt.dt,this.ddt=tt.ddt,this.t=0,this.ticks=0,this.rho=0,this.maxRho=0,this.q1=0,this.q2=0,this.q3=0,this.q4=0,this.r1=0,this.r2=0,this.r3=0,this.r4=0,this.variables=[new g({cost:new T(10,2),stepwisePowerSum:{default:!0},firstFreeCost:!0}),new g({cost:new T(5e3,2),stepwisePowerSum:{default:!0}}),new g({cost:new T(3e25,3),stepwisePowerSum:{default:!0}}),new g({cost:new T(8e50,4),stepwisePowerSum:{default:!0}}),new g({cost:new T(2e6,2),stepwisePowerSum:{default:!0}}),new g({cost:new T(3e9,2),stepwisePowerSum:{default:!0}}),new g({cost:new T(4e25,3),stepwisePowerSum:{default:!0}}),new g({cost:new T(5e50,4),stepwisePowerSum:{default:!0}})],this.boughtVars=[],this.tauH=0,this.maxTauH=0,this.pubT=0,this.pubRho=0,this.milestones=[0,0,0,0],this.pubMulti=0,this.conditions=this.getBuyingConditions(),this.milestoneConditions=this.getMilestoneConditions(),this.milestoneTree=this.getMilestoneTree(),this.updateMilestones()}getBuyingConditions(){let t=[new Array(8).fill(!0),[()=>this.curMult<4650,()=>this.curMult<2900,()=>this.curMult<2250,()=>this.curMult<1150,()=>this.curMult<4650,()=>this.curMult<2900,()=>this.curMult<2250,()=>this.curMult<1150],new Array(8).fill(!0),new Array(8).fill(!0)];return t=t.map((t=>t.map((t=>"function"==typeof t?t:()=>t)))),t}getMilestoneConditions(){return[()=>!0,()=>!0,()=>this.milestones[0]>0,()=>this.milestones[0]>1,()=>!0,()=>!0,()=>this.milestones[1]>0,()=>this.milestones[1]>1]}getMilestoneTree(){return[...new Array(4).fill([[0,0,0,0],[1,0,0,0],[2,0,0,0],[2,1,0,0],[2,2,0,0],[2,2,1,0],[2,2,2,0],[2,2,3,0],[2,2,3,1],[2,2,3,2],[2,2,3,3]])]}getTotMult(t){return Math.max(0,.198*t-p(100))+p(Math.pow(this.sigma/20,this.sigma<65?0:this.sigma<75?1:this.sigma<85?2:3))}updateMilestones(){let t=Math.min(10,Math.floor(Math.max(this.lastPub,this.maxRho)/25));this.milestones=[0,0,0,0];let s=[];if(this.stratIndex<2&&(s=[1,2,3,4]),2===this.stratIndex){let t=this.t%100;t<10?s=[3,4,1,2]:t<50?s=[1,2,3,4]:t<60?s=[3,4,1,2]:t<100&&(s=[2,1,3,4])}if(3===this.stratIndex){let t=1/0;this.lastPub>0&&(t=10),this.lastPub>75&&(t=200),this.lastPub>100&&(t=200),this.lastPub>125&&(t=200),this.lastPub>150&&(t=600),this.lastPub>200&&(t=100),this.lastPub>225&&(t=25),s=this.curMult<t?[1,2,3,4]:[3,4,1,2]}const i=[2,2,3,3];for(let e=0;e<s.length;e++)for(;this.milestones[s[e]-1]<i[s[e]-1]&&t>0;)this.milestones[s[e]-1]++,t--}simulate(){return C(this,void 0,void 0,(function*(){let t=!1;for(;!t&&tt.simulating;)(this.ticks+1)%5e5==0&&(yield o()),this.tick(),this.rho>this.maxRho&&(this.maxRho=this.rho),this.lastPub<250&&this.updateMilestones(),this.curMult=Math.pow(10,this.getTotMult(this.maxRho)-this.totMult),this.buyVariables(),t=(tt.forcedPubTime!==1/0?this.t>tt.forcedPubTime:this.t>2*this.pubT||this.pubRho>this.cap[0])&&this.pubRho>15,this.ticks++;this.pubMulti=Math.pow(10,this.getTotMult(this.pubRho)-this.totMult);let s=M(this,"");for(;this.boughtVars[this.boughtVars.length-1].timeStamp>this.pubT;)this.boughtVars.pop();return tt.varBuy.push([s[7],this.boughtVars]),s}))}tick(){let t=p(this.dt);this.q1=b(this.q1,this.variables[0].value+this.q2+t),this.q2=b(this.q2,this.variables[1].value+this.q3+t),this.q3=this.milestones[0]>0?b(this.q3,this.variables[2].value+this.q4+t):this.q3,this.q4=this.milestones[0]>1?b(this.q4,this.variables[3].value+t):this.q4,this.r1=b(this.r1,this.variables[4].value+this.r2+t),this.r2=b(this.r2,this.variables[5].value+this.r3+t),this.r3=this.milestones[1]>0?b(this.r3,this.variables[6].value+this.r4+t):this.r3,this.r4=this.milestones[1]>1?b(this.r4,this.variables[7].value+t):this.r4;let s=this.q1*(1+.05*this.milestones[2])+this.r1*(1+.05*this.milestones[3])+this.totMult+t;this.rho=b(this.rho,s),this.t+=this.dt/1.5,this.dt*=this.ddt,this.maxRho<this.recovery.value&&(this.recovery.time=this.t),this.tauH=(this.maxRho-this.lastPub)/(this.t/3600),(this.maxTauH<this.tauH||this.maxRho>=this.cap[0]-this.cap[1]||this.pubRho<15||tt.forcedPubTime!==1/0)&&(this.maxTauH=this.tauH,this.pubT=this.t,this.pubRho=this.maxRho)}buyVariables(){for(let t=this.variables.length-1;t>=0;t--)for(;this.rho>this.variables[t].cost&&this.conditions[this.stratIndex][t]()&&this.milestoneConditions[t]();){if(this.maxRho+5>this.lastPub){let s=["q1","q2","q3","q4","r1","r2","r3","r4"];this.boughtVars.push({variable:s[t],level:this.variables[t].lvl+1,cost:this.variables[t].cost,timeStamp:this.t})}this.rho=d(this.rho,this.variables[t].cost),this.variables[t].buy()}}}var P=function(t,s,i,e){return new(i||(i=Promise))((function(h,a){function o(t){try{r(e.next(t))}catch(t){a(t)}}function l(t){try{r(e.throw(t))}catch(t){a(t)}}function r(t){var s;t.done?h(t.value):(s=t.value,s instanceof i?s:new i((function(t){t(s)}))).then(o,l)}r((e=e.apply(t,s||[])).next())}))};class S{constructor(t){var s;this.stratIndex=a(t.strats,t.strat),this.strat=t.strat,this.theory="T3",this.cap="number"==typeof t.cap&&t.cap>0?[t.cap,1]:[1/0,0],this.recovery=null!==(s=t.recovery)&&void 0!==s?s:{value:0,time:0,recoveryTime:!1},this.lastPub=t.rho,this.sigma=t.sigma,this.totMult=this.getTotMult(t.rho),this.curMult=0,this.dt=tt.dt,this.ddt=tt.ddt,this.t=0,this.ticks=0,this.currencies=[0,0,0],this.maxRho=0,this.variables=[new g({cost:new T(10,1.18099),stepwisePowerSum:{default:!0},firstFreeCost:!0}),new g({cost:new T(10,1.308),stepwisePowerSum:{default:!0}}),new g({cost:new T(3e3,1.675),stepwisePowerSum:{default:!0}}),new g({cost:new T(20,6.3496),varBase:2}),new g({cost:new T(10,2.74),varBase:2}),new g({cost:new T(1e3,1.965),varBase:2}),new g({cost:new T(500,18.8343),varBase:2}),new g({cost:new T(1e5,3.65),varBase:2}),new g({cost:new T(1e5,2.27),varBase:2}),new g({cost:new T(1e4,1248.27),varBase:2}),new g({cost:new T(1e3,6.81744),varBase:2}),new g({cost:new T(1e5,2.98),varBase:2})],this.boughtVars=[],this.tauH=0,this.maxTauH=0,this.pubT=0,this.pubRho=0,this.milestones=[0,0,0,0],this.pubMulti=0,this.conditions=this.getBuyingConditions(),this.milestoneConditions=this.getMilestoneConditions(),this.milestoneTree=this.getMilestoneTree(),this.updateMilestones()}getBuyingConditions(){let t=[new Array(12).fill(!0),[!0,!0,!1,!0,!0,!1,!0,!1,!1,!1,!1,!1],[!0,!0,!0,!1,!0,!1,!1,!0,!0,!0,!0,!1],[!0,!0,!0,!0,!0,!1,!0,!0,!0,!0,!1,!1],[!0,!0,!0,!0,!0,!1,!0,!0,!0,!0,!0,!1],[!1,!0,!0,!1,!0,!1,!1,!0,!0,!1,!0,!1],[()=>this.curMult<1,!0,!0,!1,()=>!(this.curMult<1)||this.variables[4].cost+2<this.currencies[0],!1,!1,!0,!0,()=>this.curMult<1,()=>this.curMult<1,()=>this.curMult<1],[()=>this.curMult<1&&this.variables[0].cost+1<this.currencies[0],()=>this.variables[1].cost+p(3)<this.currencies[1],()=>this.variables[2].cost+p(5)<this.currencies[2],!1,()=>!(this.curMult<1)||this.variables[4].cost+2<this.currencies[0],!1,!1,()=>this.curMult<1||this.variables[7].cost+p(8)<this.currencies[1],!0,()=>this.curMult<1,()=>this.curMult<1,()=>this.curMult<1&&this.variables[11].cost+1<this.currencies[2]],[()=>this.variables[0].cost+p(7)<Math.min(this.variables[3].cost,this.variables[6].cost),()=>this.variables[1].cost+p(7)<this.variables[4].cost,!1,!0,!0,!1,!0,!1,!1,!1,!1,!1],[()=>this.variables[0].cost+p(8)<this.variables[9].cost,()=>this.variables[1].cost+p(5)<Math.min(this.variables[4].cost,this.variables[7].cost,this.variables[10].cost),()=>this.variables[2].cost+p(8)<this.variables[8].cost,!1,!0,!1,!1,!0,!0,!0,!0,!1],[()=>this.variables[0].cost+p(10)<Math.min(this.variables[6].cost,this.variables[9].cost),()=>this.variables[1].cost+p(4)<Math.min(this.variables[4].cost,this.variables[7].cost,this.variables[10].cost),()=>this.variables[2].cost+p(10)<this.variables[8].cost,!1,!0,!1,!0,!0,!0,!0,!0,!1],[()=>this.variables[0].cost+p(8)<Math.min(this.variables[3].cost,this.variables[6].cost,this.variables[9].cost),()=>this.variables[1].cost+p(5)<Math.min(this.variables[4].cost,this.variables[7].cost),()=>this.variables[2].cost+p(8)<this.variables[8].cost,!0,!0,!1,!0,!0,!0,!0,!1,!1],[()=>this.variables[0].cost+p(10)<Math.min(this.variables[3].cost,this.variables[6].cost,this.variables[9].cost),()=>this.variables[1].cost+p(4)<Math.min(this.variables[4].cost,this.variables[7].cost,this.variables[10].cost),()=>this.variables[2].cost+p(10)<this.variables[8].cost,!0,!0,!1,!0,!0,!0,!0,!0,!1],[()=>this.curMult<2&&this.variables[0].cost+p(8)<this.variables[9].cost,()=>!(this.curMult<2)||this.variables[1].cost+p(4)<Math.min(this.variables[4].cost,this.variables[10].cost)&&this.variables[1].cost+p(2)<this.variables[7].cost,()=>this.variables[2].cost+p(8)<this.variables[8].cost&&this.variables[2].cost+p(2)<this.variables[11].cost,!1,!0,!1,!1,()=>!(this.curMult<2)||this.variables[7].cost+p(2)<Math.min(this.variables[4].cost,this.variables[10].cost),!0,()=>this.curMult<2,!0,()=>this.variables[11].cost+p(4)<this.variables[8].cost],[()=>this.lastPub-this.maxRho>1&&this.variables[0].cost+p(8)<this.variables[9].cost,()=>(this.curMult<1.2?this.variables[1].cost+p(5)<this.variables[10].cost:this.variables[1].cost+p(8)<this.variables[4].cost)||this.curMult>2.4,()=>!(this.curMult<2.4)||this.variables[2].cost+p(8)<this.variables[8].cost,!1,()=>!(this.curMult<1.2)||this.variables[4].cost+2<this.variables[10].cost,!1,!1,()=>this.curMult<1.2?this.variables[7].cost+p(2.5)<this.variables[10].cost:this.variables[7].cost+p(8)<this.variables[4].cost,!0,()=>this.lastPub-this.maxRho>1,()=>this.curMult<1.2||this.curMult<2.4&&this.variables[10].cost+p(8)<this.variables[4].cost,()=>this.curMult<1.2&&this.variables[11].cost+p(10)<this.variables[8].cost]];return t=t.map((t=>t.map((t=>"function"==typeof t?t:()=>t)))),t}getMilestoneConditions(){return[()=>!0,()=>!0,()=>this.milestones[0]>0,()=>!0,()=>!0,()=>this.milestones[0]>0,()=>!0,()=>!0,()=>this.milestones[0]>0,()=>this.milestones[0]>0,()=>this.milestones[0]>0,()=>this.milestones[0]>0]}getMilestoneTree(){return[...new Array(15).fill([[0,0,0,0],[0,1,0,0],[0,2,0,0],[0,2,1,0],[0,2,2,0],[1,2,2,0],[1,2,2,1],[1,2,2,2]])]}getTotMult(t){return Math.max(0,.147*t+p(3))+p(Math.pow(this.sigma/20,this.sigma<65?0:this.sigma<75?1:this.sigma<85?2:3))}updateMilestones(){const t=Math.min(7,Math.floor(Math.max(this.lastPub,this.maxRho)/25));this.milestones=this.milestoneTree[this.stratIndex][Math.min(this.milestoneTree[this.stratIndex].length-1,t)]}simulate(){return P(this,void 0,void 0,(function*(){let t=!1;for(;!t&&tt.simulating;)(this.ticks+1)%5e5==0&&(yield o()),this.tick(),this.currencies[0]>this.maxRho&&(this.maxRho=this.currencies[0]),this.lastPub<175&&this.updateMilestones(),this.curMult=Math.pow(10,this.getTotMult(this.maxRho)-this.totMult),this.buyVariables(),t=(tt.forcedPubTime!==1/0?this.t>tt.forcedPubTime:this.t>2*this.pubT||this.pubRho>this.cap[0])&&this.pubRho>9,this.ticks++;this.pubMulti=Math.pow(10,this.getTotMult(this.pubRho)-this.totMult);let s=M(this,"");for(;this.boughtVars[this.boughtVars.length-1].timeStamp>this.pubT;)this.boughtVars.pop();return tt.varBuy.push([s[7],this.boughtVars]),s}))}tick(){let t=this.variables[0].value*(1+.05*this.milestones[1]),s=this.variables[1].value*(1+.05*this.milestones[2]),i=this.variables[2].value*(1+.05*this.milestones[3]),e=b(b(this.variables[3].value+t,this.variables[4].value+s),this.variables[5].value+i);this.currencies[0]=b(this.currencies[0],p(this.dt)+this.totMult+e);let h=b(b(this.variables[6].value+t,this.variables[7].value+s),this.variables[8].value+i);this.currencies[1]=b(this.currencies[1],p(this.dt)+this.totMult+h);let a=b(b(this.variables[9].value+t,this.variables[10].value+s),this.variables[11].value+i);this.currencies[2]=this.milestones[0]>0?b(this.currencies[2],p(this.dt)+this.totMult+a):0,this.t+=this.dt/1.5,this.dt*=this.ddt,this.maxRho<this.recovery.value&&(this.recovery.time=this.t),this.tauH=(this.maxRho-this.lastPub)/(this.t/3600),(this.maxTauH<this.tauH||this.maxRho>=this.cap[0]-this.cap[1]||this.pubRho<9||tt.forcedPubTime!==1/0)&&(this.maxTauH=this.tauH,this.pubT=this.t,this.pubRho=this.maxRho)}buyVariables(){for(let t=this.variables.length-1;t>=0;t--){let s=t%3;for(;this.currencies[s]>this.variables[t].cost&&this.conditions[this.stratIndex][t]()&&this.milestoneConditions[t]();){if(this.maxRho+5>this.lastPub){let s=["b1","b2","b3","c11","c12","c13","c21","c22","c23","c31","c32","c33"];this.boughtVars.push({variable:s[t],level:this.variables[t].lvl+1,cost:this.variables[t].cost,timeStamp:this.t})}this.currencies[s]=d(this.currencies[s],this.variables[t].cost),this.variables[t].buy()}}}}var R=function(t,s,i,e){return new(i||(i=Promise))((function(h,a){function o(t){try{r(e.next(t))}catch(t){a(t)}}function l(t){try{r(e.throw(t))}catch(t){a(t)}}function r(t){var s;t.done?h(t.value):(s=t.value,s instanceof i?s:new i((function(t){t(s)}))).then(o,l)}r((e=e.apply(t,s||[])).next())}))};class I{constructor(t){var s;this.stratIndex=a(t.strats,t.strat),this.strat=t.strat,this.theory="T4",this.cap="number"==typeof t.cap&&t.cap>0?[t.cap,2]:[1/0,0],this.recovery=null!==(s=t.recovery)&&void 0!==s?s:{value:0,time:0,recoveryTime:!1},this.recursionValue=t.recursionValue,this.lastPub=t.rho,this.sigma=t.sigma,this.totMult=this.getTotMult(t.rho),this.curMult=0,this.dt=tt.dt,this.ddt=tt.ddt,this.t=0,this.ticks=0,this.rho=0,this.maxRho=0,this.q=0,this.variables=[new g({cost:new T(5,1.305),stepwisePowerSum:{default:!0},firstFreeCost:!0}),new g({cost:new T(20,3.75),varBase:2}),new g({cost:new T(2e3,2.468),varBase:2}),new g({cost:new T(1e4,4.85),varBase:3}),new g({cost:new T(1e8,12.5),varBase:5}),new g({cost:new T(1e10,58),varBase:10}),new g({cost:new T(1e3,100),stepwisePowerSum:{default:!0}}),new g({cost:new T(1e4,1e3),varBase:2})],this.variableSum=0,this.boughtVars=[],this.tauH=0,this.maxTauH=0,this.pubT=0,this.pubRho=0,this.milestones=[0,0,0],this.pubMulti=0,this.conditions=this.getBuyingConditions(),this.milestoneConditions=this.getMilestoneConditions(),this.milestoneTree=this.getMilestoneTree(),this.updateMilestones()}getBuyingConditions(){let t=[[...new Array(8).fill(!0)],[!0,!0,...new Array(6).fill(!1)],[!1,!1,!0,...new Array(3).fill(!1),!0,!0],[...new Array(3).fill(!1),!0,!1,!1,!0,!0],[...new Array(4).fill(!1),!0,!1,!0,!0],[...new Array(4).fill(!1),!0,!0,!0,!0],[()=>this.variables[0].cost+1<this.variables[1].cost,!0,!1,!1,!1,!1,!1,!1],[()=>this.variables[0].cost+1<Math.min(this.variables[1].cost),!0,!0,!1,!1,!1,()=>this.variables[6].cost+1<this.variables[7].cost,!0],[()=>this.variables[0].cost+1<this.variables[1].cost&&this.maxRho<this.lastPub,()=>this.maxRho<this.lastPub,!1,!0,!0,!0,!0,!0],[()=>this.variables[0].cost+1<this.variables[1].cost&&this.maxRho<this.lastPub,()=>this.maxRho<this.lastPub,!0,!1,!0,!0,!0,!0],[...new Array(4).fill(!1),!0,!0,()=>this.variables[6].cost+1<this.variables[7].cost,!0],[!1,!1,()=>{var t;return this.variables[2].cost+.1<(null!==(t=this.recursionValue)&&void 0!==t?t:1/0)},...new Array(3).fill(!1),()=>{var t;return this.variables[6].cost+p(10+this.variables[6].lvl%10)<=Math.min(this.variables[7].cost,this.variables[2].cost)&&this.variables[6].cost+p(10+this.variables[6].lvl%10)+1<(null!==(t=this.recursionValue)&&void 0!==t?t:1/0)},()=>{var t;return this.variables[7].cost+.5<(null!==(t=this.recursionValue)&&void 0!==t?t:1/0)&&(this.curMult<1||this.variables[7].cost+p(1.5)<=this.variables[2].cost)}]];return t=t.map((t=>t.map((t=>"function"==typeof t?t:()=>t)))),t}getMilestoneConditions(){return[()=>!0,()=>!0,()=>!0,()=>this.milestones[0]>0,()=>this.milestones[0]>1,()=>this.milestones[0]>2,()=>!0,()=>!0]}getMilestoneTree(){return[[[0,0,0],[1,0,0],[2,0,0],[3,0,0],[3,0,1],[3,0,2],[3,0,3],[3,1,3]],[[0,0,0],[0,1,0]],[[0,0,0],[0,0,1],[0,0,2],[0,0,3]],[[0,0,0],[1,0,0],[1,0,1],[1,0,2],[1,0,3]],[[0,0,0],[1,0,0],[2,0,0],[2,0,1],[2,0,2],[2,0,3]],[[0,0,0],[1,0,0],[2,0,0],[3,0,0],[3,0,1],[3,0,2],[3,0,3],[3,0,3]],[[0,0,0],[0,1,0]],[[0,0,0],[0,1,0],[0,1,1],[0,1,2],[0,1,3]],[[0,0,0],[1,0,0],[1,0,1],[1,0,2],[1,0,3]],[[0,0,0],[0,1,0],[0,1,1],[0,1,2],[0,1,3],[1,1,3],[2,1,3],[3,1,3]],[[0,0,0],[1,0,0],[2,0,0],[3,0,0],[3,0,1],[3,0,2],[3,0,3],[3,0,3]],[[0,0,0],[0,0,1],[0,0,2],[0,0,3]]]}getTotMult(t){return Math.max(0,.165*t-p(4))+p(Math.pow(this.sigma/20,this.sigma<65?0:this.sigma<75?1:this.sigma<85?2:3))}updateMilestones(){const t=Math.min(7,Math.floor(Math.max(this.lastPub,this.maxRho)/25));if(this.milestones=this.milestoneTree[this.stratIndex][Math.min(this.milestoneTree[this.stratIndex].length-1,t)],8===this.stratIndex){const s=[3,1,3];let i;this.milestones=[0,0,0],i=this.maxRho<this.lastPub?[2,3,1]:this.t%100<50?[3,1,2]:[1,3,2];let e=t;this.milestones=[0,0,0];for(let t=0;t<i.length;t++)for(;this.milestones[i[t]-1]<s[i[t]-1]&&e>0;)this.milestones[i[t]-1]++,e--}}simulate(t){return R(this,void 0,void 0,(function*(){if(null==this.recursionValue&&"T4C3d66"===this.strat&&tt.forcedPubTime===1/0){t.recursionValue=Number.MAX_VALUE;let s=yield new I(t).simulate(t);this.recursionValue=s[9][0]}let s=!1;for(;!s&&tt.simulating;)(this.ticks+1)%5e5==0&&(yield o()),this.tick(),this.rho>this.maxRho&&(this.maxRho=this.rho),this.lastPub<176&&this.updateMilestones(),this.curMult=Math.pow(10,this.getTotMult(this.maxRho)-this.totMult),this.buyVariables(),s=tt.forcedPubTime!==1/0?this.t>tt.forcedPubTime:(this.t>2*this.pubT||this.pubRho>this.cap[0])&&this.pubRho>9,this.ticks++;this.pubMulti=Math.pow(10,this.getTotMult(this.pubRho)-this.totMult);let i=M(this,11===this.stratIndex?` q1:${this.variables[6].lvl} q2:${this.variables[7].lvl}`:"");for(;this.boughtVars[this.boughtVars.length-1].timeStamp>this.pubT;)this.boughtVars.pop();return tt.varBuy.push([i[7],this.boughtVars]),i}))}tick(){let t=this.variables[6].value,s=this.variables[7].value,i=p(2)*this.milestones[2]+t+s-b(0,this.q);this.q=b(this.q,i+p(this.dt));let e=this.totMult+this.variableSum;this.rho=b(this.rho,e+p(this.dt)),this.t+=this.dt/1.5,this.dt*=11===this.stratIndex&&this.recursionValue===Number.MAX_VALUE?Math.min(1.3,10*this.ddt):this.ddt,this.maxRho<this.recovery.value&&(this.recovery.time=this.t),this.tauH=(this.maxRho-this.lastPub)/(this.t/3600),(this.maxTauH<this.tauH||this.maxRho>=this.cap[0]-this.cap[1]||this.pubRho<9||tt.forcedPubTime!==1/0)&&(this.maxTauH=this.tauH,this.pubT=this.t,this.pubRho=this.maxRho)}buyVariables(){for(let t=this.variables.length-1;t>=0;t--)for(;this.rho>this.variables[t].cost&&this.conditions[this.stratIndex][t]()&&this.milestoneConditions[t]();){if(this.maxRho+5>this.lastPub){let s=["c1","c2","c3","c4","c5","c6","q1","q2"];this.boughtVars.push({variable:s[t],level:this.variables[t].lvl+1,cost:this.variables[t].cost,timeStamp:this.t})}this.rho=d(this.rho,this.variables[t].cost),this.variables[t].buy()}let t=this.variables[0].value*(1+.15*this.milestones[1]),s=this.variables[1].value;this.variableSum=t+s,this.variables[2].lvl>0&&(this.variableSum=b(this.variableSum,this.variables[2].value+this.q)),this.variables[3].lvl>0&&(this.variableSum=b(this.variableSum,this.variables[3].value+2*this.q)),this.variables[4].lvl>0&&(this.variableSum=b(this.variableSum,this.variables[4].value+3*this.q)),this.variables[5].lvl>0&&(this.variableSum=b(this.variableSum,this.variables[5].value+4*this.q))}}var V=function(t,s,i,e){return new(i||(i=Promise))((function(h,a){function o(t){try{r(e.next(t))}catch(t){a(t)}}function l(t){try{r(e.throw(t))}catch(t){a(t)}}function r(t){var s;t.done?h(t.value):(s=t.value,s instanceof i?s:new i((function(t){t(s)}))).then(o,l)}r((e=e.apply(t,s||[])).next())}))};class A{constructor(t){var s;this.stratIndex=a(t.strats,t.strat),this.strat=t.strat,this.theory="T5",this.cap="number"==typeof t.cap&&t.cap>0?[t.cap,1]:[1/0,0],this.recovery=null!==(s=t.recovery)&&void 0!==s?s:{value:0,time:0,recoveryTime:!1},this.lastPub=t.rho,this.sigma=t.sigma,this.totMult=this.getTotMult(t.rho),this.curMult=0,this.dt=tt.dt,this.ddt=tt.ddt,this.t=0,this.ticks=0,this.rho=0,this.maxRho=0,this.q=0,this.variables=[new g({cost:new T(10,1.61328),stepwisePowerSum:{default:!0},firstFreeCost:!0}),new g({cost:new T(15,64),varBase:2}),new g({cost:new T(1e6,1.18099),value:1,stepwisePowerSum:{default:!0}}),new g({cost:new T(75,4.53725),varBase:2}),new g({cost:new T(1e3,88550700),varBase:2})],this.c2worth=!0,this.boughtVars=[],this.tauH=0,this.maxTauH=0,this.pubT=0,this.pubRho=0,this.milestones=[0,0,0],this.pubMulti=0,this.conditions=this.getBuyingConditions(),this.milestoneConditions=this.getMilestoneConditions(),this.milestoneTree=this.getMilestoneTree(),this.updateMilestones()}getBuyingConditions(){let t=[[!0,!0,!0,!0,!0],[!0,!0,()=>this.maxRho+(this.lastPub-200)/165<this.lastPub,()=>this.c2worth,!0],[()=>this.variables[0].cost+p(3+this.variables[0].lvl%10)<=Math.min(this.variables[1].cost,this.variables[3].cost,this.milestones[2]>0?this.variables[4].cost:1e3),!0,()=>this.q+p(1.5)<this.variables[3].value+this.variables[4].value*(1+.05*this.milestones[2])||!this.c2worth,()=>this.c2worth,!0]];return t=t.map((t=>t.map((t=>"function"==typeof t?t:()=>t)))),t}getMilestoneConditions(){return[()=>!0,()=>!0,()=>!0,()=>!0,()=>this.milestones[1]>0]}getMilestoneTree(){return[...new Array(3).fill([[0,0,0],[0,1,0],[1,1,0],[2,1,0],[3,1,0],[3,1,1],[3,1,2]])]}getTotMult(t){return Math.max(0,.159*t)+p(Math.pow(this.sigma/20,this.sigma<65?0:this.sigma<75?1:this.sigma<85?2:3))}updateMilestones(){const t=Math.min(6,Math.floor(Math.max(this.lastPub,this.maxRho)/25));this.milestones=this.milestoneTree[this.stratIndex][Math.min(this.milestoneTree[this.stratIndex].length-1,t)]}calculateQ(t,s,i){let e=Math.log10(Math.E),h=-1/0;s+i>this.q?h=d(s+i,this.q):s+i<this.q&&(h=d(this.q,s+i));let a=s+i>=this.q?1:-1,o=0;return h>this.q?o=-Math.pow(10,s-t-i+a*Math.log10((h-this.q)/e)):h<this.q&&(o=Math.pow(10,s-t-i+a*Math.log10((this.q-h)/e))),s+i-Math.log10(1+1/Math.pow(Math.E,(o+this.dt)*Math.pow(10,t-s+i)))}simulate(){return V(this,void 0,void 0,(function*(){let t=!1;for(;!t&&tt.simulating;)(this.ticks+1)%5e5==0&&(yield o()),this.tick(),this.rho>this.maxRho&&(this.maxRho=this.rho),this.lastPub<150&&this.updateMilestones(),this.curMult=Math.pow(10,this.getTotMult(this.maxRho)-this.totMult),this.buyVariables(),t=(tt.forcedPubTime!==1/0?this.t>tt.forcedPubTime:this.t>2*this.pubT||this.pubRho>this.cap[0])&&this.pubRho>7,this.ticks++;this.pubMulti=Math.pow(10,this.getTotMult(this.pubRho)-this.totMult);let s=M(this,1===this.stratIndex?" "+c(this.variables[2].cost,1):"");for(;this.boughtVars[this.boughtVars.length-1].timeStamp>this.pubT;)this.boughtVars.pop();return tt.varBuy.push([s[7],this.boughtVars]),s}))}tick(){let t=this.variables[0].value*(1+.05*this.milestones[0]),s=this.milestones[1]>0?this.variables[4].value*(1+.05*this.milestones[2]):0;this.q=this.calculateQ(this.variables[2].value,this.variables[3].value,s);let i=t+this.variables[1].value+this.q;this.rho=b(this.rho,i+this.totMult+p(this.dt)),this.t+=this.dt/1.5,this.dt*=this.ddt,this.maxRho<this.recovery.value&&(this.recovery.time=this.t),this.tauH=(this.maxRho-this.lastPub)/(this.t/3600),(this.maxTauH<this.tauH||this.maxRho>=this.cap[0]-this.cap[1]||this.pubRho<7||tt.forcedPubTime!==1/0)&&(this.maxTauH=this.tauH,this.pubT=this.t,this.pubRho=this.maxRho)}buyVariables(){let t=0,s=this.milestones[1]>0?this.variables[4].value*(1+.05*this.milestones[2]):0,i=this.calculateQ(this.variables[2].value,this.variables[3].value,s);this.c2worth=i>=this.variables[3].value+s+p(2/3);for(let e=this.variables.length-1;e>=0;e--)for(;this.rho>this.variables[e].cost&&this.conditions[this.stratIndex][e]()&&this.milestoneConditions[e]();){if(this.maxRho+5>this.lastPub){let t=["q1","q2","c1","c2","c3"];this.boughtVars.push({variable:t[e],level:this.variables[e].lvl+1,cost:this.variables[e].cost,timeStamp:this.t})}this.rho=d(this.rho,this.variables[e].cost),this.variables[e].buy(),3===e&&(t++,i=this.calculateQ(this.variables[2].value,this.variables[3].value+p(2)*t,s),this.c2worth=i>=this.variables[3].value+p(2)*t+this.variables[4].value*(1+.05*this.milestones[2])+p(2/3))}}}var H=function(t,s,i,e){return new(i||(i=Promise))((function(h,a){function o(t){try{r(e.next(t))}catch(t){a(t)}}function l(t){try{r(e.throw(t))}catch(t){a(t)}}function r(t){var s;t.done?h(t.value):(s=t.value,s instanceof i?s:new i((function(t){t(s)}))).then(o,l)}r((e=e.apply(t,s||[])).next())}))};class k{constructor(t){var s;this.stratIndex=a(t.strats,t.strat),this.strat=t.strat,this.theory="T6",this.cap="number"==typeof t.cap&&t.cap>0?[t.cap,1]:[1/0,0],this.recovery=null!==(s=t.recovery)&&void 0!==s?s:{value:0,time:0,recoveryTime:!1},this.lastPub=t.rho,this.sigma=t.sigma,this.totMult=this.getTotMult(t.rho),this.curMult=0,this.dt=tt.dt,this.ddt=tt.ddt,this.t=0,this.ticks=0,this.rho=0,this.maxRho=0,this.q=0,this.r=0,this.variables=[new g({cost:new T(15,3),stepwisePowerSum:{default:!0},firstFreeCost:!0}),new g({cost:new T(500,100),varBase:2}),new g({cost:new T(1e25,1e5),stepwisePowerSum:{default:!0}}),new g({cost:new T(1e30,1e10),varBase:2}),new g({cost:new T(10,2),value:1,stepwisePowerSum:{default:!0}}),new g({cost:new T(100,5),varBase:2}),new g({cost:new T(1e7,1.255),stepwisePowerSum:{default:!0}}),new g({cost:new T(1e25,5e5),varBase:2}),new g({cost:new T(15,3.9),varBase:2})],this.k=0,this.stopC12=[0,0,!0],this.boughtVars=[],this.tauH=0,this.maxTauH=0,this.pubT=0,this.pubRho=0,this.milestones=[0,0,0],this.pubMulti=0,this.conditions=this.getBuyingConditions(),this.milestoneConditions=this.getMilestoneConditions(),this.milestoneTree=this.getMilestoneTree(),this.updateMilestones()}getBuyingConditions(){let t=[[!0,!0,!0,!0,!0,!0,!0,!0,!0],[!0,!0,!0,!0,!1,!1,!0,!1,!1],[!0,!0,!0,!0,!1,!1,!1,!0,!1],[!0,!0,!0,!0,!0,!0,!1,!1,!0],[!0,!0,!0,!0,!0,!0,!1,!1,!1],[!0,!0,!0,!0,!1,!1,!1,!1,!0],[!0,!0,!0,!0,()=>this.stopC12[2],()=>this.stopC12[2],!1,!1,!0],[()=>this.variables[0].cost+p(3)<Math.min(this.variables[1].cost,this.variables[3].cost,this.variables[6].cost),!0,()=>this.variables[2].cost+p(3)<Math.min(this.variables[1].cost,this.variables[3].cost,this.variables[6].cost),!0,!1,!1,!0,!1,!1],[()=>this.variables[0].cost+p(5)<Math.min(this.variables[1].cost,this.variables[3].cost,this.variables[7].cost),!0,()=>this.variables[2].cost+p(5)<Math.min(this.variables[1].cost,this.variables[3].cost,this.variables[7].cost),!0,!1,!1,!1,!0,!1],[()=>this.variables[0].cost+p(8)<Math.min(this.variables[1].cost,this.variables[3].cost,this.variables[5].cost,this.milestones[2]>0?this.variables[8].cost:1/0),!0,()=>this.variables[2].cost+p(8)<Math.min(this.variables[1].cost,this.variables[3].cost,this.variables[5].cost,this.milestones[2]>0?this.variables[8].cost:1/0),!0,()=>this.variables[4].cost+p(8)<Math.min(this.variables[1].cost,this.variables[3].cost,this.variables[5].cost,this.milestones[2]>0?this.variables[8].cost:1/0),!0,!1,!1,!0],[()=>this.variables[0].cost+p(8)<Math.min(this.variables[1].cost,this.variables[3].cost,this.variables[5].cost),!0,()=>this.variables[2].cost+p(8)<Math.min(this.variables[1].cost,this.variables[3].cost,this.variables[5].cost),!0,()=>this.variables[4].cost+p(8)<Math.min(this.variables[1].cost,this.variables[3].cost,this.variables[5].cost),!0,!1,!1,!1],[()=>this.variables[0].cost+p(7+this.variables[0].lvl%10)<Math.min(this.variables[1].cost,this.variables[3].cost,this.milestones[2]>0?this.variables[8].cost:1/0),!0,()=>this.variables[2].cost+p(5)<Math.min(this.variables[1].cost,this.variables[3].cost,this.milestones[2]>0?this.variables[8].cost:1/0),!0,!1,!1,!1,!1,!0],[!1]];return t=t.map((t=>t.map((t=>"function"==typeof t?t:()=>t)))),t}getMilestoneConditions(){return[()=>!0,()=>!0,()=>this.milestones[0]>0,()=>this.milestones[0]>0,()=>!0,()=>!0,()=>!0,()=>!0,()=>this.milestones[2]>0]}getMilestoneTree(){return[...new Array(13).fill([[0,0,0,0],[0,1,0,0],[1,1,0,0],[1,1,1,0],[1,0,0,3],[1,0,1,3],[1,1,1,3]])]}getTotMult(t){return Math.max(0,.196*t)-p(50)+p(Math.pow(this.sigma/20,this.sigma<65?0:this.sigma<75?1:this.sigma<85?2:3))}updateMilestones(){const t=Math.min(6,Math.floor(Math.max(this.lastPub,this.maxRho)/25));this.milestones=this.milestoneTree[this.stratIndex][Math.min(this.milestoneTree[this.stratIndex].length-1,t)]}calculateIntegral(t,s,i,e,h){let a=t+s+this.q+this.r,o=i+2*this.q+this.r-p(2),l=this.milestones[1]>0?e+3*this.q+this.r-p(3):0,r=this.milestones[2]>0?h+this.q+2*this.r-p(2):0;return this.k=r-a,this.totMult+b(a,b(o,b(l,r)))}simulate(){return H(this,void 0,void 0,(function*(){let t=!1;for(;!t&&tt.simulating;)(this.ticks+1)%5e5==0&&(yield o()),this.tick(),this.rho>this.maxRho&&(this.maxRho=this.rho),this.lastPub<150&&this.updateMilestones(),this.curMult=Math.pow(10,this.getTotMult(this.maxRho)-this.totMult),this.buyVariables(),t=(tt.forcedPubTime!==1/0?this.t>tt.forcedPubTime:this.t>2*this.pubT||this.pubRho>this.cap[0])&&this.pubRho>12,this.ticks++;this.pubMulti=Math.pow(10,this.getTotMult(this.pubRho)-this.totMult);let s=M(this,"T6snax"===this.strat?" "+c(this.stopC12[0],1):"");for(;this.boughtVars[this.boughtVars.length-1].timeStamp>this.pubT;)this.boughtVars.pop();return tt.varBuy.push([s[7],this.boughtVars]),s}))}tick(){let t=this.variables[4].value*(1+.05*this.milestones[3]),s=d(this.calculateIntegral(t,this.variables[5].value,this.variables[6].value,this.variables[7].value,this.variables[8].value),this.rho);this.q=b(this.q,this.variables[0].value+this.variables[1].value+p(this.dt)),this.r=this.milestones[0]>0?b(this.r,this.variables[2].value+this.variables[3].value+p(this.dt)-3):0;let i=this.calculateIntegral(t,this.variables[5].value,this.variables[6].value,this.variables[7].value,this.variables[8].value);s=s>i?i:s,this.rho=Math.max(0,d(i,s)),this.k>.3?this.stopC12[1]++:this.stopC12[1]=0,this.stopC12[1]>30&&this.stopC12[2]&&(this.stopC12[0]=this.maxRho,this.stopC12[2]=!1),this.t+=this.dt/1.5,this.dt*=this.ddt,this.maxRho<this.recovery.value&&(this.recovery.time=this.t),this.tauH=(this.maxRho-this.lastPub)/(this.t/3600),(this.maxTauH<this.tauH||this.maxRho>=this.cap[0]-this.cap[1]||this.pubRho<12||tt.forcedPubTime!==1/0)&&(this.maxTauH=this.tauH,this.pubT=this.t,this.pubRho=this.maxRho)}buyVariables(){if(12!==this.stratIndex)for(let t=this.variables.length-1;t>=0;t--)for(;this.rho>this.variables[t].cost&&this.conditions[this.stratIndex][t]()&&this.milestoneConditions[t]();){if(this.maxRho+5>this.lastPub){let s=["q1","q2","r1","r2","c1","c2","c3","c4","c5"];this.boughtVars.push({variable:s[t],level:this.variables[t].lvl+1,cost:this.variables[t].cost,timeStamp:this.t})}this.rho=d(this.rho,this.variables[t].cost),this.variables[t].buy()}else for(;;){let t=this.variables.map((t=>t.cost)),s=[p(7+this.variables[0].lvl%10),0,p(5+this.variables[2].lvl%10),0,Math.max(0,this.k)+p(8+this.variables[4].lvl%10),Math.max(0,this.k),1/0,1/0,-Math.min(0,this.k)],i=[Number.MAX_VALUE,-1];for(let e=this.variables.length-1;e>=0;e--)t[e]+s[e]<i[0]&&this.milestoneConditions[e]()&&(i=[t[e]+s[e],e]);if(!(-1!==i[1]&&t[i[1]]<this.rho))break;if(this.rho=d(this.rho,this.variables[i[1]].cost),this.maxRho+5>this.lastPub){let t=["q1","q2","r1","r2","c1","c2","c3","c4","c5"];this.boughtVars.push({variable:t[i[1]],level:this.variables[i[1]].lvl+1,cost:this.variables[i[1]].cost,timeStamp:this.t})}this.variables[i[1]].buy()}}}var q=function(t,s,i,e){return new(i||(i=Promise))((function(h,a){function o(t){try{r(e.next(t))}catch(t){a(t)}}function l(t){try{r(e.throw(t))}catch(t){a(t)}}function r(t){var s;t.done?h(t.value):(s=t.value,s instanceof i?s:new i((function(t){t(s)}))).then(o,l)}r((e=e.apply(t,s||[])).next())}))};class O{constructor(t){var s;this.stratIndex=a(t.strats,t.strat),this.strat=t.strat,this.theory="T7",this.cap="number"==typeof t.cap&&t.cap>0?[t.cap,1]:[1/0,0],this.recovery=null!==(s=t.recovery)&&void 0!==s?s:{value:0,time:0,recoveryTime:!1},this.lastPub=t.rho,this.sigma=t.sigma,this.totMult=this.getTotMult(t.rho),this.curMult=0,this.dt=tt.dt,this.ddt=tt.ddt,this.t=0,this.ticks=0,this.rho=0,this.maxRho=0,this.rho2=0,this.variables=[new g({cost:new T(500,1.51572),stepwisePowerSum:{default:!0},firstFreeCost:!0}),new g({cost:new T(10,1.275),value:1,stepwisePowerSum:{default:!0}}),new g({cost:new T(40,8),varBase:2}),new g({cost:new T(1e5,63),varBase:2}),new g({cost:new T(10,2.82),varBase:2}),new g({cost:new T(1e8,60),varBase:2}),new g({cost:new T(100,2.81),varBase:2})],this.drho13=0,this.drho23=0,this.c2ratio=1/0,this.boughtVars=[],this.tauH=0,this.maxTauH=0,this.pubT=0,this.pubRho=0,this.milestones=[0,0,0,0,0],this.pubMulti=0,this.conditions=this.getBuyingConditions(),this.milestoneConditions=this.getMilestoneConditions(),this.milestoneTree=this.getMilestoneTree(),this.updateMilestones()}getBuyingConditions(){this.lastPub>=100&&(this.c2ratio=100),this.lastPub>=175&&(this.c2ratio=10),this.lastPub>=250&&(this.c2ratio=20),this.lastPub>=275&&(this.c2ratio=50),this.lastPub>=300&&(this.c2ratio=1/0);let t=[[!0,!0,!0,!0,!0,!0,!0],[!0,!0,!0,!1,!1,!1,!1],[!0,!1,!1,!0,!1,!1,!1],[!0,!1,!1,!0,!0,!0,!0],[!0,!1,!1,!1,!0,!0,!0],[!0,!1,!1,!1,!1,!0,!0],[()=>this.variables[0].cost+1<this.variables[2].cost,()=>this.variables[1].cost+p(8)<this.variables[2].cost,!0,!1,!1,!1,!1],[()=>this.variables[0].cost+1<this.variables[3].cost,!1,!1,!0,!1,!1,!1],[()=>this.variables[0].cost+p(4)<this.variables[6].cost,()=>this.variables[1].cost+p(10+this.variables[2].lvl)<this.variables[2].cost,()=>this.variables[2].cost+p(this.c2ratio)<this.variables[6].cost,()=>this.variables[3].cost+1<this.variables[6].cost,()=>this.variables[4].cost+1<this.variables[6].cost,()=>this.variables[5].cost+p(4)<this.variables[6].cost,!0]];return t=t.map((t=>t.map((t=>"function"==typeof t?t:()=>t)))),t}getMilestoneConditions(){return[()=>!0,()=>!0,()=>!0,()=>this.milestones[1]>0,()=>this.milestones[0]>0,()=>this.milestones[2]>0,()=>this.milestones[3]>0]}getMilestoneTree(){return[[[0,0,0,0,0],[0,1,0,0,0],[1,1,0,0,0],[1,1,1,0,0],[1,1,1,1,0],[1,1,1,1,1],[1,1,1,1,2],[1,1,1,1,3]],[[0,0,0,0,0],[0,0,0,0,1],[0,0,0,0,2],[0,0,0,0,3]],[[0,0,0,0,0],[0,1,0,0,0]],[[0,0,0,0,0],[0,1,0,0,0],[1,1,0,0,0],[1,1,1,0,0],[1,1,1,1,0]],[[0,0,0,0,0],[1,0,0,0,0],[1,0,1,0,0],[1,0,1,1,0]],[[0,0,0,0,0],[1,0,0,0,0],[1,0,1,0,0],[1,0,1,1,0]],[[0,0,0,0,0],[0,0,0,0,1],[0,0,0,0,2],[0,0,0,0,3]],[[0,0,0,0,0],[0,1,0,0,0]],[[0,0,0,0,0],[0,1,0,0,0],[1,1,0,0,0],[1,1,1,0,0],[1,1,1,1,0],[1,1,1,1,1],[1,1,1,1,2],[1,1,1,1,3]]]}getTotMult(t){return Math.max(0,.152*t)+p(Math.pow(this.sigma/20,this.sigma<65?0:this.sigma<75?1:this.sigma<85?2:3))}updateMilestones(){const t=Math.min(7,Math.floor(Math.max(this.lastPub,this.maxRho)/25));this.milestones=this.milestoneTree[this.stratIndex][Math.min(this.milestoneTree[this.stratIndex].length-1,t)]}simulate(){return q(this,void 0,void 0,(function*(){let t=!1;for(;!t&&tt.simulating;)(this.ticks+1)%5e5==0&&(yield o()),this.tick(),this.rho>this.maxRho&&(this.maxRho=this.rho),this.lastPub<175&&this.updateMilestones(),this.curMult=Math.pow(10,this.getTotMult(this.maxRho)-this.totMult),this.buyVariables(),t=(tt.forcedPubTime!==1/0?this.t>tt.forcedPubTime:this.t>2*this.pubT||this.pubRho>this.cap[0])&&this.pubRho>10,this.ticks++;this.pubMulti=Math.pow(10,this.getTotMult(this.pubRho)-this.totMult);let s=M(this,"T7PlaySpqcey"===this.strat&&this.c2ratio!==1/0?this.c2ratio.toString():"");for(;this.boughtVars[this.boughtVars.length-1].timeStamp>this.pubT;)this.boughtVars.pop();return tt.varBuy.push([s[7],this.boughtVars]),s}))}tick(){let t=this.variables[1].value*(1+.05*this.milestones[4])+this.variables[2].value,s=this.milestones[1]>0?p(1.5)+this.variables[3].value+this.rho/2:0,i=this.milestones[0]>0?this.variables[4].value:0,e=this.milestones[2]>0?p(1.5)+this.variables[5].value+this.rho2/2:0;this.drho13=this.milestones[3]>0?Math.min(this.drho13+2,Math.min(p(.5)+this.variables[6].value+this.rho2/2-this.rho/2,this.rho+2)):0,this.drho23=this.milestones[3]>0?Math.min(this.drho23+2,Math.min(p(.5)+this.variables[6].value+this.rho/2-this.rho2/2,this.rho2+2)):0;let h=p(this.dt)+this.variables[0].value+this.totMult;this.rho=b(this.rho,h+b(b(t,s),this.drho13)),this.rho2=b(this.rho2,h+b(b(i,e),this.drho23)),this.t+=this.dt/1.5,this.dt*=this.ddt,this.maxRho<this.recovery.value&&(this.recovery.time=this.t),this.tauH=(this.maxRho-this.lastPub)/(this.t/3600),(this.maxTauH<this.tauH||this.maxRho>=this.cap[0]-this.cap[1]||this.pubRho<10||tt.forcedPubTime!==1/0)&&(this.maxTauH=this.tauH,this.pubT=this.t,this.pubRho=this.maxRho)}buyVariables(){for(let t=this.variables.length-1;t>=0;t--)for(;this.rho>this.variables[t].cost&&this.conditions[this.stratIndex][t]()&&this.milestoneConditions[t]();){if(this.maxRho+5>this.lastPub){let s=["q1","c1","c2","c3","c4","c5","c6"];this.boughtVars.push({variable:s[t],level:this.variables[t].lvl+1,cost:this.variables[t].cost,timeStamp:this.t})}this.rho=d(this.rho,this.variables[t].cost),this.variables[t].buy()}}}var L=function(t,s,i,e){return new(i||(i=Promise))((function(h,a){function o(t){try{r(e.next(t))}catch(t){a(t)}}function l(t){try{r(e.throw(t))}catch(t){a(t)}}function r(t){var s;t.done?h(t.value):(s=t.value,s instanceof i?s:new i((function(t){t(s)}))).then(o,l)}r((e=e.apply(t,s||[])).next())}))};class F{constructor(t){var s;this.stratIndex=a(t.strats,t.strat),this.strat=t.strat,this.theory="T8",this.cap="number"==typeof t.cap&&t.cap>0?[t.cap,1]:[1/0,0],this.recovery=null!==(s=t.recovery)&&void 0!==s?s:{value:0,time:0,recoveryTime:!1},this.lastPub=t.rho,this.sigma=t.sigma,this.totMult=this.getTotMult(t.rho),this.curMult=0,this.dt=tt.dt,this.ddt=tt.ddt,this.t=0,this.ticks=0,this.rho=0,this.maxRho=0,this.variables=[new g({cost:new T(10,1.5172),stepwisePowerSum:{default:!0},firstFreeCost:!0}),new g({cost:new T(20,64),varBase:2}),new g({cost:new T(100,1.15*Math.log2(3),!0),varBase:3}),new g({cost:new T(100,1.15*Math.log2(5),!0),varBase:5}),new g({cost:new T(100,1.15*Math.log2(7),!0),varBase:7})],this.boughtVars=[],this.tauH=0,this.maxTauH=0,this.pubT=0,this.pubRho=0,this.milestones=[0,0,0,0],this.bounds=[[[0,-20,20],[0,-27,27],[24.5,1,48]],[[.5,-23,24],[1,-25,27],[20.5,1,40]],[[1,-20,22],[-1.5,-21,18],[8,0,37]]],this.defaultStates=[[-6,-8,26],[-10.6,-4.4,28.6],[-6,15,0]],this.dts=[.02,.002,14e-5],this.x=this.defaultStates[this.milestones[0]][0],this.y=this.defaultStates[this.milestones[0]][1],this.z=this.defaultStates[this.milestones[0]][2],this.dx=0,this.dy=0,this.dz=0,this.msTimer=0,this.pubMulti=0,this.conditions=this.getBuyingConditions(),this.milestoneConditions=this.getMilestoneConditions(),this.milestoneTree=this.getMilestoneTree(),this.updateMilestones()}getBuyingConditions(){let t=[[!0,!0,!0,!0,!0],[!0,!0,!1,!0,!0],[!0,!0,!0,!0,!1],[!0,!0,!1,!0,!1],[()=>this.curMult<1.6,!0,()=>this.curMult<2.3,!0,()=>this.curMult<2.3],[()=>this.variables[0].cost+1<Math.min(this.variables[1].cost,this.variables[3].cost),!0,!1,!0,!0],[()=>this.variables[0].cost+1<Math.min(this.variables[1].cost,this.variables[3].cost),!0,!0,!0,!1],[()=>this.variables[0].cost+1<Math.min(this.variables[1].cost,this.variables[3].cost),!0,!1,!0,!1],[()=>this.variables[0].cost+1<Math.min(this.variables[1].cost,this.variables[3].cost),!0,!0,!0,!0],[()=>this.variables[0].cost+p(8)<Math.min(this.variables[1].cost,this.variables[3].cost),!0,()=>this.variables[2].cost+p(2.5)<Math.min(this.variables[1].cost,this.variables[3].cost),!0,()=>this.variables[4].cost+p(4)<Math.min(this.variables[1].cost,this.variables[3].cost)],[()=>this.variables[0].cost+p(8)<Math.min(this.variables[1].cost,this.variables[3].cost),!0,()=>this.variables[2].cost+p(2.5)<Math.min(this.variables[1].cost,this.variables[3].cost),!0,()=>this.variables[4].cost+p(2.5)<Math.min(this.variables[1].cost,this.variables[3].cost)]];return t=t.map((t=>t.map((t=>"function"==typeof t?t:()=>t)))),t}getMilestoneConditions(){return[()=>!0,()=>!0,()=>!0,()=>!0,()=>!0]}getMilestoneTree(){return[[[0,0,0,0],[1,0,0,0],[2,0,0,0],[0,0,0,3],[1,0,3,0],[2,0,3,0],[2,0,3,1],[2,0,3,2],[2,0,3,3],[2,1,3,3],[2,2,3,3],[2,3,3,3]],[[0,0,0,0],[1,0,0,0],[2,0,0,0],[2,0,1,0],[2,0,2,0],[2,0,3,0],[2,0,3,1],[2,0,3,2],[2,0,3,3]],[[0,0,0,0],[1,0,0,0],[2,0,0,0],[2,0,1,0],[2,0,2,0],[2,0,3,0],[2,1,3,0],[2,2,3,0],[2,3,3,0]],[[0,0,0,0],[1,0,0,0],[2,0,0,0],[2,0,1,0],[2,0,2,0],[2,0,3,0]],[[0,0,0,0],[1,0,0,0],[2,0,0,0],[0,0,0,3],[1,0,3,0],[2,0,3,0],[2,0,3,1],[2,0,3,2],[2,0,3,3],[2,1,3,3],[2,2,3,3],[2,3,3,3]],[[0,0,0,0],[1,0,0,0],[2,0,0,0],[2,0,1,0],[2,0,2,0],[2,0,3,0],[2,0,3,1],[2,0,3,2],[2,0,3,3]],[[0,0,0,0],[1,0,0,0],[2,0,0,0],[2,0,1,0],[2,0,2,0],[2,0,3,0],[2,1,3,0],[2,2,3,0],[2,3,3,0]],[[0,0,0,0],[1,0,0,0],[2,0,0,0],[2,0,1,0],[2,0,2,0],[2,0,3,0]],...new Array(3).fill([[0,0,0,0],[1,0,0,0],[2,0,0,0],[0,0,0,3],[1,0,3,0],[2,0,3,0],[2,0,3,1],[2,0,3,2],[2,0,3,3],[2,1,3,3],[2,2,3,3],[2,3,3,3]])]}getTotMult(t){return Math.max(0,.15*t)+p(Math.pow(this.sigma/20,this.sigma<65?0:this.sigma<75?1:this.sigma<85?2:3))}updateMilestones(){const t=Math.min(11,Math.floor(Math.max(this.lastPub,this.maxRho)/20));this.milestones=this.milestoneTree[this.stratIndex][Math.min(this.milestoneTree[this.stratIndex].length-1,t)]}dn(t=this.x,s=this.y,i=this.z){0===this.milestones[0]&&(this.dx=10*(s-t),this.dy=t*(28-i)-s,this.dz=t*s-8*i/3),1===this.milestones[0]&&(this.dx=40*(s-t)*10,this.dy=10*(-12*t-t*i+28*s),this.dz=10*(t*s-3*i)),2===this.milestones[0]&&(this.dx=500*(-s-i),this.dy=500*(t+.1*s),this.dz=500*(.1+i*(t-14)))}simulate(){return L(this,void 0,void 0,(function*(){let t=!1;for(;!t&&tt.simulating;)(this.ticks+1)%5e5==0&&(yield o()),this.tick(),this.rho>this.maxRho&&(this.maxRho=this.rho),this.lastPub<220&&this.updateMilestones(),this.curMult=Math.pow(10,this.getTotMult(this.maxRho)-this.totMult),this.buyVariables(),t=(tt.forcedPubTime!==1/0?this.t>tt.forcedPubTime:this.t>2*this.pubT||this.pubRho>this.cap[0])&&this.pubRho>8,this.ticks++;this.pubMulti=Math.pow(10,this.getTotMult(this.pubRho)-this.totMult);let s=M(this,"");for(;this.boughtVars[this.boughtVars.length-1].timeStamp>this.pubT;)this.boughtVars.pop();return tt.varBuy.push([s[7],this.boughtVars]),s}))}tick(){this.dn();let t=this.x+.5*this.dx*this.dts[this.milestones[0]],s=this.y+.5*this.dy*this.dts[this.milestones[0]],i=this.z+.5*this.dz*this.dts[this.milestones[0]];this.dn(t,s,i),this.x+=this.dx*this.dts[this.milestones[0]],this.y+=this.dy*this.dts[this.milestones[0]],this.z+=this.dz*this.dts[this.milestones[0]],this.dn();let e=5*(this.bounds[this.milestones[0]][0][1]-this.bounds[this.milestones[0]][0][0])+this.bounds[this.milestones[0]][0][0],h=5*(this.bounds[this.milestones[0]][0][2]-this.bounds[this.milestones[0]][0][0])+this.bounds[this.milestones[0]][0][0],a=5*(this.bounds[this.milestones[0]][1][1]-this.bounds[this.milestones[0]][1][0])+this.bounds[this.milestones[0]][1][0],o=5*(this.bounds[this.milestones[0]][1][2]-this.bounds[this.milestones[0]][1][0])+this.bounds[this.milestones[0]][1][0],l=5*(this.bounds[this.milestones[0]][2][1]-this.bounds[this.milestones[0]][2][0])+this.bounds[this.milestones[0]][2][0],r=5*(this.bounds[this.milestones[0]][2][2]-this.bounds[this.milestones[0]][2][0])+this.bounds[this.milestones[0]][2][0];(this.x<e||this.x>h||this.y<a||this.y>o||this.z<l||this.z>r)&&(this.x=this.defaultStates[this.milestones[0]][0],this.y=this.defaultStates[this.milestones[0]][1],this.z=this.defaultStates[this.milestones[0]][2]),this.dn(),this.msTimer++,335==this.msTimer&&10===this.stratIndex&&(this.x=this.defaultStates[this.milestones[0]][0],this.y=this.defaultStates[this.milestones[0]][1],this.z=this.defaultStates[this.milestones[0]][2],this.msTimer=0);let n=this.variables[2].value*(1+.05*this.milestones[1]),u=this.variables[3].value*(1+.05*this.milestones[2]),c=this.variables[4].value*(1+.05*this.milestones[3]),v=n+p(this.dx*this.dx),m=u+p(this.dy*this.dy),d=c+p(this.dz*this.dz),f=p(this.dt)+this.totMult+this.variables[0].value+this.variables[1].value+b(b(v,m),d)/2-2;this.rho=b(this.rho,f),this.t+=this.dt/1.5,this.dt*=this.ddt,this.maxRho<this.recovery.value&&(this.recovery.time=this.t),this.tauH=(this.maxRho-this.lastPub)/(this.t/3600),(this.maxTauH<this.tauH||this.maxRho>=this.cap[0]-this.cap[1]||this.pubRho<8||tt.forcedPubTime!==1/0)&&(this.maxTauH=this.tauH,this.pubT=this.t,this.pubRho=this.maxRho)}buyVariables(){for(let t=this.variables.length-1;t>=0;t--)for(;this.rho>this.variables[t].cost&&this.conditions[this.stratIndex][t]()&&this.milestoneConditions[t]();){if(this.maxRho+5>this.lastPub){let s=["c1","c2","c3","c4","c5"];this.boughtVars.push({variable:s[t],level:this.variables[t].lvl+1,cost:this.variables[t].cost,timeStamp:this.t})}this.rho=d(this.rho,this.variables[t].cost),this.variables[t].buy()}}}var E=function(t,s,i,e){return new(i||(i=Promise))((function(h,a){function o(t){try{r(e.next(t))}catch(t){a(t)}}function l(t){try{r(e.throw(t))}catch(t){a(t)}}function r(t){var s;t.done?h(t.value):(s=t.value,s instanceof i?s:new i((function(t){t(s)}))).then(o,l)}r((e=e.apply(t,s||[])).next())}))};class D{constructor(t){var s;this.srK_helper=t=>{let s=t*t;return Math.log(s+1/6+1/120/s+1/810/s/s)/2-1},this.sineRatioK=(t,s,i=5)=>{if(t<1||s>=t+1)return 0;let e=t+1+i,h=s*s,a=this.srK_helper(e+s),o=this.srK_helper(e-s),l=e*(a+o-2*this.srK_helper(e))+s*(a-o)-Math.log(1-h/e/e)/2;for(let s=t+1;s<e;++s)l-=Math.log(1-h/s/s);return Math.LOG10E*l},this.stratIndex=a(t.strats,t.strat),this.strat=t.strat,this.theory="WSP",this.tauFactor=r(this.theory),this.cap="number"==typeof t.cap&&t.cap>0?[t.cap,1]:[1/0,0],this.recovery=null!==(s=t.recovery)&&void 0!==s?s:{value:0,time:0,recoveryTime:!1},this.lastPub=t.rho,this.sigma=t.sigma,this.totMult=this.getTotMult(t.rho),this.curMult=0,this.dt=tt.dt,this.ddt=tt.ddt,this.t=0,this.ticks=0,this.rho=0,this.maxRho=0,this.q=0,this.variables=[new g({cost:new T(10,.845,!0),stepwisePowerSum:{default:!0},firstFreeCost:!0}),new g({cost:new T(1e3,10.14,!0),varBase:2}),new g({cost:new T(20,3.38,!0)}),new g({cost:new T(50,3.38/1.5,!0),stepwisePowerSum:{base:2,length:50}}),new g({cost:new T(1e10,33.8,!0),varBase:2})],this.S=0,this.boughtVars=[],this.tauH=0,this.maxTauH=0,this.pubT=0,this.pubRho=0,this.milestones=[0,0,0],this.pubMulti=0,this.conditions=this.getBuyingConditions(),this.milestoneConditions=this.getMilestoneConditions(),this.milestoneTree=this.getMilestoneTree(),this.updateMilestones()}getBuyingConditions(){let t=0;this.lastPub>=25&&(t=p(3)),this.lastPub>=40&&(t=1),this.lastPub>=200&&(t=p(50)),this.lastPub>=400&&(t=3),this.lastPub>=700&&(t=1e4);let s=[[!0,!0,!0,!0,!0],[!0,!0,!0,()=>this.lastPub<450||this.t<15,!0],[()=>this.variables[0].cost+p(8+this.variables[0].lvl%10)<Math.min(this.variables[1].cost,this.variables[2].cost,this.milestones[1]>0?this.variables[4].cost:1/0),!0,!0,()=>this.variables[3].cost+t<Math.min(this.variables[1].cost,this.variables[2].cost,this.milestones[1]>0?this.variables[4].cost:1/0)||this.t<15,!0]];return s=s.map((t=>t.map((t=>"function"==typeof t?t:()=>t)))),s}getMilestoneConditions(){return[()=>!0,()=>!0,()=>!0,()=>!0,()=>this.milestones[1]>0]}getMilestoneTree(){return[...new Array(3).fill([[0,0,0],[0,0,1],[0,0,2],[0,0,3],[0,1,3],[1,1,3],[2,1,3],[3,1,3],[4,1,3]])]}getTotMult(t){return Math.max(0,t*this.tauFactor*1.5)}updateMilestones(){let t=0,s=[10,25,40,55,70,100,140,200];for(let i=0;i<s.length;i++)Math.max(this.lastPub,this.maxRho)>=s[i]&&(t=i+1);this.milestones=this.milestoneTree[this.stratIndex][Math.min(this.milestoneTree[this.stratIndex].length-1,t)]}updateS(){let t=p(this.variables[2].value),s=this.variables[3].value,i=Math.pow(10,p(Math.PI)+s+t-b(s,t-p(3)*this.milestones[2]))+1;this.S=this.sineRatioK(this.variables[2].value,i/Math.PI)}simulate(){return E(this,void 0,void 0,(function*(){let t=!1;for(;!t&&tt.simulating;)(this.ticks+1)%5e5==0&&(yield o()),this.tick(),this.rho>this.maxRho&&(this.maxRho=this.rho),this.lastPub<200&&this.updateMilestones(),this.curMult=Math.pow(10,this.getTotMult(this.maxRho)-this.totMult),this.buyVariables(),t=(tt.forcedPubTime!==1/0?this.t>tt.forcedPubTime:this.t>2*this.pubT||this.pubRho>this.cap[0]||this.curMult>15)&&this.pubRho>8,this.ticks++;this.pubMulti=Math.pow(10,this.getTotMult(this.pubRho)-this.totMult);let s=M(this,"");for(;this.boughtVars[this.boughtVars.length-1].timeStamp>this.pubT;)this.boughtVars.pop();return tt.varBuy.push([s[7],this.boughtVars]),s}))}tick(){let t=this.variables[0].value*(1+.01*this.milestones[0]),s=Math.max(0,p(this.dt)+this.S+this.variables[4].value);this.q=b(this.q,s);let i=this.totMult+t+this.variables[1].value+this.q+p(this.dt);this.rho=b(this.rho,i),this.t+=this.dt/1.5,this.dt*=this.ddt,this.maxRho<this.recovery.value&&(this.recovery.time=this.t),this.tauH=(this.maxRho-this.lastPub)/(this.t/3600),(this.maxTauH<this.tauH||this.maxRho>=this.cap[0]-this.cap[1]||this.pubRho<8||tt.forcedPubTime!==1/0)&&(this.maxTauH=this.tauH,this.pubT=this.t,this.pubRho=this.maxRho)}buyVariables(){let t=!1;for(let s=this.variables.length-1;s>=0;s--)for(;this.rho>this.variables[s].cost&&this.conditions[this.stratIndex][s]()&&this.milestoneConditions[s]();){if(this.rho=d(this.rho,this.variables[s].cost),this.maxRho+5>this.lastPub){let t=["q1","q2","n","c1","c2"];this.boughtVars.push({variable:t[s],level:this.variables[s].lvl+1,cost:this.variables[s].cost,timeStamp:this.t})}this.variables[s].buy(),2!==s&&4!==s||(t=!0)}t&&this.updateS()}}var $=function(t,s,i,e){return new(i||(i=Promise))((function(h,a){function o(t){try{r(e.next(t))}catch(t){a(t)}}function l(t){try{r(e.throw(t))}catch(t){a(t)}}function r(t){var s;t.done?h(t.value):(s=t.value,s instanceof i?s:new i((function(t){t(s)}))).then(o,l)}r((e=e.apply(t,s||[])).next())}))};class _{constructor(t){var s;this.updateInverseE_Gamma=t=>{let s=p(p(2)/Math.LOG10E+t/Math.LOG10E+p(Math.PI)/Math.LOG10E)-(p(2)+t);this.inverseE_Gamma=0-Math.LOG10E-b(d(s,s+s-p(2)),s+s+s+p(6))},this.stratIndex=a(t.strats,t.strat),this.strat=t.strat,this.theory="SL",this.tauFactor=r(this.theory),this.cap="number"==typeof t.cap&&t.cap>0?[t.cap,1]:[1/0,0],this.recovery=null!==(s=t.recovery)&&void 0!==s?s:{value:0,time:0,recoveryTime:!1},this.lastPub=t.rho,this.sigma=t.sigma,this.totMult=this.getTotMult(t.rho),this.curMult=0,this.dt=tt.dt,this.ddt=tt.ddt,this.t=0,this.ticks=0,this.rho=0,this.maxRho=0,this.rho2=0,this.rho3=0,this.q=0,this.variables=[new g({cost:new T(1,.369*Math.log2(10),!0),stepwisePowerSum:{base:3.5,length:3},firstFreeCost:!0}),new g({cost:new T(175,10),varBase:2}),new g({cost:new T(500,.649*Math.log2(10),!0),stepwisePowerSum:{base:6.5,length:4}}),new g({cost:new T(1e3,.926*Math.log2(10),!0),varBase:2})],this.inverseE_Gamma=0,this.boughtVars=[],this.tauH=0,this.maxTauH=0,this.pubT=0,this.pubRho=0,this.milestones=[0,0,0,0],this.pubMulti=0,this.conditions=this.getBuyingConditions(),this.milestoneConditions=this.getMilestoneConditions(),this.updateMilestones()}getBuyingConditions(){let t=[[!0,!0,!0,!0],[()=>this.curMult<4.5,()=>this.curMult<4.5,()=>this.curMult<6,()=>this.curMult<6],[()=>this.curMult<4.5&&this.variables[0].cost+p(this.variables[0].lvl%3*2+1e-4)<this.variables[1].cost,()=>this.curMult<4.5,()=>this.curMult<6&&this.variables[2].cost+p(this.variables[2].cost%4)<this.variables[3].cost,()=>this.curMult<6],[()=>this.curMult<4,()=>this.curMult<4,()=>this.curMult<7.5,()=>this.curMult<7.5],[()=>this.curMult<4&&this.variables[0].cost+p(this.variables[0].lvl%3*2+1e-4)<this.variables[1].cost,()=>this.curMult<4,()=>this.curMult<7.5&&this.variables[2].cost+p(this.variables[2].cost%4)<this.variables[3].cost,()=>this.curMult<7.5]];return t=t.map((t=>t.map((t=>"function"==typeof t?t:()=>t)))),t}getMilestoneConditions(){return[()=>!0,()=>!0,()=>!0,()=>!0]}getTotMult(t){return Math.max(0,t*this.tauFactor*1.5)}updateMilestones(){let t=Math.max(this.lastPub,this.maxRho),s=Math.min(13,Math.floor(t/25));this.milestones=[0,0,0,0];let i=[4,3,1,2];if(this.stratIndex>2&&t>=25&&t<=300){let s=5,e=4;t<50?(s=5,e=4):t<75?(s=7,e=6):t<100?(s=12,e=10):t<150?(s=20,e=15):t<175?(s=8,e=6):t<200?(s=1.5,e=1):t<275?(s=3,e=3):t<300&&(s=2,e=2);let h=Math.min(this.variables[2].cost,this.variables[3].cost);this.rho+p(s)<h?i=[4,3,1,2]:this.curMult>4.5||this.rho+p(e)>h?i=[1,2,4,3]:this.rho+p(s)>h&&this.rho+p(e)<h&&(i=[2,1,4,3])}const e=[3,5,2,2];for(let t=0;t<i.length;t++)for(;this.milestones[i[t]-1]<e[i[t]-1]&&s>0;)this.milestones[i[t]-1]++,s--}simulate(){return $(this,void 0,void 0,(function*(){let t=!1;for(;!t&&tt.simulating;)(this.ticks+1)%5e5==0&&(yield o()),this.tick(),this.rho>this.maxRho&&(this.maxRho=this.rho),this.lastPub<300&&this.updateMilestones(),this.curMult=Math.pow(10,this.getTotMult(this.maxRho)-this.totMult),this.buyVariables(),t=(tt.forcedPubTime!==1/0?this.t>tt.forcedPubTime:this.t>2*this.pubT||this.pubRho>this.cap[0]||this.curMult>15)&&this.pubRho>10,this.ticks++;this.pubMulti=Math.pow(10,this.getTotMult(this.pubRho)-this.totMult);let s=M(this,"");for(;this.boughtVars[this.boughtVars.length-1].timeStamp>this.pubT;)this.boughtVars.pop();return tt.varBuy.push([s[7],this.boughtVars]),s}))}tick(){let t=this.variables[2].value*(1+.02*this.milestones[2])+this.variables[3].value*(1+.02*this.milestones[3]);this.rho3=b(this.rho3,t+p(this.dt)),this.updateInverseE_Gamma(Math.max(1,this.rho3));let s=Math.LOG10E*(this.variables[0].value/Math.LOG10E+this.variables[1].value/Math.LOG10E-Math.log(2-.008*this.milestones[1])*(Math.max(1,this.rho3)/Math.LOG10E));this.rho2=b(this.rho2,Math.max(0,s)+p(this.dt));let i=this.rho2*(1+.02*this.milestones[0])*.5+this.inverseE_Gamma;this.rho=b(this.rho,i+this.totMult+p(this.dt)),this.t+=this.dt/1.5,this.dt*=this.ddt,this.maxRho<this.recovery.value&&(this.recovery.time=this.t),this.tauH=(this.maxRho-this.lastPub)/(this.t/3600),(this.maxTauH<this.tauH||this.maxRho>=this.cap[0]-this.cap[1]||this.pubRho<10||tt.forcedPubTime!==1/0)&&(this.maxTauH=this.tauH,this.pubT=this.t,this.pubRho=this.maxRho)}buyVariables(){for(let t=this.variables.length-1;t>=0;t--)for(;this.rho>this.variables[t].cost&&this.conditions[this.stratIndex][t]()&&this.milestoneConditions[t]();){if(this.maxRho+5>this.lastPub){let s=["a1","a2","b1","b2"];this.boughtVars.push({variable:s[t],level:this.variables[t].lvl+1,cost:this.variables[t].cost,timeStamp:this.t})}this.rho=d(this.rho,this.variables[t].cost),this.variables[t].buy()}}}var N=function(t,s,i,e){return new(i||(i=Promise))((function(h,a){function o(t){try{r(e.next(t))}catch(t){a(t)}}function l(t){try{r(e.throw(t))}catch(t){a(t)}}function r(t){var s;t.done?h(t.value):(s=t.value,s instanceof i?s:new i((function(t){t(s)}))).then(o,l)}r((e=e.apply(t,s||[])).next())}))};function z(t){return N(this,void 0,void 0,(function*(){let s=new W(t);return yield s.simulate(t)}))}class W{constructor(t){var s,i;this.stratIndex=a(t.strats,t.strat),this.strat=t.strat,this.theory="EF",this.tauFactor=r(this.theory),this.cap="number"==typeof t.cap&&t.cap>0?[t.cap,1]:[1/0,0],this.recovery=null!==(s=t.recovery)&&void 0!==s?s:{value:0,time:0,recoveryTime:!1},this.lastPub=t.rho,this.sigma=t.sigma,this.totMult=this.getTotMult(t.rho),this.curMult=0,this.dt=tt.dt,this.ddt=tt.ddt,this.t=0,this.ticks=0,this.currencies=[0,0,0],this.maxRho=0,this.q=0,this.t_var=0,this.variables=[new g({cost:new T(1e6,1e6)}),new g({cost:new T(10,1.61328),stepwisePowerSum:{default:!0},firstFreeCost:!0}),new g({cost:new T(5,60),varBase:2}),new g({cost:new T(20,200),stepwisePowerSum:{default:!0},firstFreeCost:!0}),new g({cost:new T(100,2),varBase:1.1}),new g({cost:new T(20,200),stepwisePowerSum:{default:!0},firstFreeCost:!0}),new g({cost:new T(100,2),varBase:1.1}),new g({cost:new T(2e3,2.2,!0),stepwisePowerSum:{default:!0},firstFreeCost:!0}),new g({cost:new T(500,2.2,!0),value:1,stepwisePowerSum:{base:40,length:10}}),new g({cost:new T(500,2.2,!0),varBase:2})],this.recursionValue=null!==(i=t.recursionValue)&&void 0!==i?i:[1/0,0],this.lastA23=[0,0],this.boughtVars=[],this.tauH=0,this.maxTauH=0,this.pubT=0,this.pubRho=0,this.milestones=[0,0,0,0,0],this.nextMilestoneCost=1/0,this.pubMulti=0,this.conditions=this.getBuyingConditions(),this.milestoneConditions=this.getMilestoneConditions(),this.milestoneTree=this.getMilestoneTree(),this.updateMilestones()}getBuyingConditions(){let t=[[...new Array(10).fill(!0)],[!0,()=>this.curMult<1,!0,()=>this.curMult<1,()=>this.curMult<1,()=>this.curMult<1,()=>this.curMult<1,()=>this.curMult<1||this.lastPub>150,!0,!0],[!0,()=>this.variables[1].cost+1<this.variables[2].cost,!0,!0,!0,!0,!0,()=>this.variables[6].cost+p(2.5)<this.variables[2].cost,!0,!0],[!0,()=>this.variables[1].cost+p(10+this.variables[1].lvl%10)<this.variables[2].cost&&this.variables[1].cost+p(this.variables[1].lvl%10+5)<this.recursionValue[0],()=>this.variables[2].cost+.2<this.recursionValue[0],()=>this.variables[3].cost+p(5)<this.variables[8].cost||this.milestones[1]<2||this.curMult<1,()=>this.variables[4].cost+p(5)<this.variables[8].cost||this.milestones[1]<2||this.curMult<1,()=>this.variables[5].cost+p(5)<this.variables[9].cost||this.milestones[1]<2||this.curMult<1,()=>this.variables[6].cost+p(5)<this.variables[9].cost||this.milestones[1]<2||this.curMult<1,()=>(this.variables[7].cost+p(4+this.variables[7].lvl%10/2)<this.variables[2].cost||this.variables[2].cost>this.recursionValue[0])&&this.variables[7].cost+p(this.variables[7].lvl%10/3)<this.recursionValue[0],!0,!0]];return t=t.map((t=>t.map((t=>"function"==typeof t?t:()=>t)))),t}getMilestoneConditions(){return[()=>this.variables[0].lvl<4&&this.maxRho+p(5)<this.nextMilestoneCost,()=>this.maxRho+p(5)<this.nextMilestoneCost,()=>this.maxRho+p(5)<this.nextMilestoneCost,()=>this.milestones[0]>0&&this.maxRho+p(5)<this.nextMilestoneCost,()=>this.milestones[0]>0&&this.maxRho+p(5)<this.nextMilestoneCost,()=>this.milestones[0]>1&&this.maxRho+p(5)<this.nextMilestoneCost,()=>this.milestones[0]>1&&this.maxRho+p(5)<this.nextMilestoneCost,()=>this.milestones[1]>0&&this.maxRho+p(5)<this.nextMilestoneCost,()=>this.milestones[1]>1,()=>this.milestones[1]>2]}getMilestoneTree(){return[...new Array(4).fill([[0,0,0,0,0],[1,0,0,0,0],[2,0,0,0,0],[2,1,0,0,0],[2,2,0,0,0],[2,3,0,0,0],[2,3,1,0,0],[2,3,2,0,0],[2,3,3,0,0],[2,3,4,0,0],[2,3,5,0,0],[2,3,5,1,0],[2,3,5,2,0],[2,3,5,2,1],[2,3,5,2,2]])]}getTotMult(t){return Math.max(0,t*this.tauFactor*.387)}updateMilestones(){let t=0,s=[10,20,30,40,50,70,90,110,130,150,250,275,300,325];for(let i=0;i<s.length;i++)if(Math.max(this.lastPub,this.maxRho)>=s[i]&&(t=i+1),s[i]>Math.max(this.lastPub,this.maxRho)){this.nextMilestoneCost=s[i];break}Math.max(this.lastPub,this.maxRho)>325&&(this.nextMilestoneCost=1/0),this.milestones=this.milestoneTree[this.stratIndex][Math.min(this.milestoneTree[this.stratIndex].length-1,t)],this.variables[4].varBase!==1.1+.01*this.milestones[3]&&(this.variables[4].varBase=1.1+.01*this.milestones[3],this.variables[4].reCalculate()),this.variables[6].varBase!==1.1+.0125*this.milestones[4]&&(this.variables[6].varBase=1.1+.0125*this.milestones[4],this.variables[6].reCalculate())}evaluatePubConditions(){if(3!==this.stratIndex)return!1;let t=0,s=0,i=[10,20,30,40,50,70,90,110,130,150,250,275,300,325];for(let e=0;e<i.length;e++)Math.max(this.lastPub,this.maxRho)>=i[e]&&(t=e+1),this.lastPub>=i[e]&&(s=e+1);return this.lastPub<30&&this.maxRho>32.4||this.lastPub<40&&this.maxRho>42||this.lastPub<50&&this.maxRho>55||this.lastPub<70&&this.maxRho>72||this.lastPub<90&&this.maxRho>92||this.lastPub<110&&this.maxRho>113||this.lastPub<150&&this.maxRho>153||this.lastPub<130&&this.maxRho>134||this.lastPub<146&&this.lastPub>145&&this.curMult>2||this.lastPub<126&&this.lastPub>125&&this.curMult>2||this.lastPub<106&&this.lastPub>105&&this.curMult>3||this.lastPub<87&&this.lastPub>85&&this.curMult>3||this.lastPub<67&&this.lastPub>65&&this.curMult>3||this.lastPub<46.4&&this.lastPub>44.7&&this.curMult>3||this.lastPub<37&&this.lastPub>36&&this.curMult>3||this.lastPub<27&&this.lastPub>26&&this.curMult>3||this.lastPub<298.2&&this.maxRho>300||this.lastPub<323.2&&this.maxRho>325||t-s<1&&this.curMult>t-s+2.6&&this.recursionValue[1]<2&&3===this.stratIndex||2===this.recursionValue[1]&&this.pubRho>this.variables[7].cost+p(4)&&this.variables[7].cost+p(this.variables[7].lvl%10/3)>this.recursionValue[0]}forcedPubConditions(){return 3!==this.stratIndex||(this.lastPub<296||this.pubRho>300)&&(this.lastPub<321||this.pubRho>325)}evaluateTauHConditions(){return 3===this.stratIndex&&(this.lastPub<298.2&&this.lastPub>=296||this.lastPub>=321&&this.lastPub<323.2)}simulate(t){return N(this,void 0,void 0,(function*(){if(this.lastPub>=10&&null==t.recursionValue&&3===this.stratIndex){t.recursionValue=[1/0,0];let s=yield z(t);t.recursionValue=[s[9][0],1];let i=yield z(t);this.recursionValue=[i[9][0],2],this.recursionValue[0]>300&&this.recursionValue[0]<301&&(this.recursionValue[0]=299.2),this.recursionValue[0]>325&&this.recursionValue[0]<326&&(this.recursionValue[0]=324.2)}let s=!1;for(;!s&&tt.simulating;)(this.ticks+1)%5e5==0&&(yield o()),this.tick(),this.currencies[0]>this.maxRho&&(this.maxRho=this.currencies[0]),this.lastPub<325&&this.updateMilestones(),this.curMult=Math.pow(10,this.getTotMult(this.maxRho)-this.totMult),this.buyVariables(),s=(tt.forcedPubTime!==1/0?this.t>tt.forcedPubTime:this.t>2*this.pubT||this.pubRho>this.cap[0]||this.evaluatePubConditions())&&this.pubRho>10&&this.forcedPubConditions(),this.ticks++;this.pubMulti=Math.pow(10,this.getTotMult(this.pubRho)-this.totMult);let i=M(this,3===this.stratIndex?` q1: ${this.variables[1].lvl} q2: ${this.variables[2].lvl} a1: ${this.variables[7].lvl}`+(tt.showA23?` a2: ${this.lastA23[0]} a3: ${this.lastA23[1]}`:""):"");if(3!==this.stratIndex||2===this.recursionValue[1]){for(;this.boughtVars[this.boughtVars.length-1].timeStamp>this.pubT;)this.boughtVars.pop();tt.varBuy.push([i[7],this.boughtVars])}return i}))}tick(){let t=p(this.dt)+this.totMult;this.q=b(this.q,this.variables[1].value+this.variables[2].value+t),this.t_var+=this.dt*(this.variables[0].lvl/5+.2);let s=(this.variables[7].value+this.variables[8].value+this.variables[9].value)*(.1*this.milestones[2]+1),i=this.variables[3].value+this.variables[4].value,e=this.variables[5].value+this.variables[6].value,h=i+p(Math.abs(Math.cos(this.t_var))),a=e+p(Math.abs(Math.sin(this.t_var)));switch(this.currencies[1]=this.milestones[0]>0?b(this.currencies[1],t+2*h):0,this.currencies[2]=this.milestones[0]>1?b(this.currencies[2],t+2*a):0,this.milestones[0]){case 0:this.currencies[0]=b(this.currencies[0],t+(p(this.t_var)+2*this.q)/2);break;case 1:this.currencies[0]=b(this.currencies[0],t+b(p(this.t_var)+2*this.q,2*this.currencies[1])/2);break;case 2:this.currencies[0]=b(this.currencies[0],t+s+b(b(p(this.t_var)+2*this.q,2*this.currencies[1]),2*this.currencies[2])/2)}this.t+=this.dt/1.5,this.dt*=3===this.stratIndex&&this.recursionValue[1]<2?Math.min(1.3,50*this.ddt):this.ddt,this.maxRho<this.recovery.value&&(this.recovery.time=this.t),this.tauH=(this.maxRho-this.lastPub)/(this.t/3600),(this.maxTauH<this.tauH||this.maxRho>=this.cap[0]-this.cap[1]||this.pubRho<10||tt.forcedPubTime!==1/0||this.evaluateTauHConditions())&&(this.maxTauH=this.tauH,this.pubT=this.t,this.pubRho=this.maxRho,this.lastA23=[this.variables[8].lvl,this.variables[9].lvl])}buyVariables(){let t=[0,0,0,1,1,2,2,0,1,2];for(let s=this.variables.length-1;s>=0;s--)for(;this.currencies[t[s]]>this.variables[s].cost&&this.conditions[this.stratIndex][s]()&&this.milestoneConditions[s]();){if(this.maxRho+5>this.lastPub&&(3!==this.stratIndex||2===this.recursionValue[1])){let t=["t","q1","q2","b1","b2","c1","c2","a1","a2","a3"];this.boughtVars.push({variable:t[s],level:this.variables[s].lvl+1,cost:this.variables[s].cost,timeStamp:this.t})}this.currencies[t[s]]=d(this.currencies[t[s]],this.variables[s].cost),this.variables[s].buy()}}}var J=function(t,s,i,e){return new(i||(i=Promise))((function(h,a){function o(t){try{r(e.next(t))}catch(t){a(t)}}function l(t){try{r(e.throw(t))}catch(t){a(t)}}function r(t){var s;t.done?h(t.value):(s=t.value,s instanceof i?s:new i((function(t){t(s)}))).then(o,l)}r((e=e.apply(t,s||[])).next())}))};class G{constructor(t){var s,i;this.stratIndex=a(t.strats,t.strat),this.strat=t.strat,this.theory="CSR2",this.tauFactor=r(this.theory),this.cap="number"==typeof t.cap&&t.cap>0?[t.cap,1]:[1/0,0],this.recovery=null!==(s=t.recovery)&&void 0!==s?s:{value:0,time:0,recoveryTime:!1},this.lastPub=t.rho,this.sigma=t.sigma,this.totMult=this.getTotMult(t.rho),this.curMult=0,this.dt=tt.dt,this.ddt=tt.ddt,this.t=0,this.ticks=0,this.rho=0,this.maxRho=0,this.q=0,this.t_var=0,this.variables=[new g({cost:new T(10,5),stepwisePowerSum:{default:!0},firstFreeCost:!0}),new g({cost:new T(15,128),varBase:2}),new g({cost:new T(1e6,16),value:1,stepwisePowerSum:{default:!0}}),new g({cost:new T(50,Math.pow(2,3.346*Math.log2(256)))}),new g({cost:new T(1e3,Math.pow(10,5.65)),varBase:2})],this.recursionValue=null!==(i=t.recursionValue)&&void 0!==i?i:[1/0,0],this.bestCoast=[0,0],this.updateError_flag=!0,this.error=0,this.boughtVars=[],this.tauH=0,this.maxTauH=0,this.pubT=0,this.pubRho=0,this.milestones=[0,0,0],this.pubMulti=0,this.conditions=this.getBuyingConditions(),this.milestoneConditions=this.getMilestoneConditions(),this.updateMilestones()}getBuyingConditions(){let t=[[!0,!0,!0,!0,!0],[()=>this.variables[0].cost+p(7+this.variables[0].lvl%10)<Math.min(this.variables[1].cost,this.variables[3].cost,this.variables[4].cost),!0,()=>this.variables[2].cost+p(15+this.variables[2].lvl%10)<Math.min(this.variables[1].cost,this.variables[3].cost,this.variables[4].cost),!0,!0],[()=>this.variables[0].cost+p(7+this.variables[0].lvl%10)<Math.min(this.variables[1].cost,this.variables[3].cost,this.variables[4].cost),()=>this.variables[1].cost+p(1.8)<this.variables[4].cost,()=>this.variables[2].cost+p(15+this.variables[2].lvl%10)<Math.min(this.variables[1].cost,this.variables[3].cost,this.variables[4].cost),()=>this.variables[3].cost+p(1.3)<this.variables[4].cost,!0]];return t=t.map((t=>t.map((t=>"function"==typeof t?t:()=>t)))),t}getMilestoneConditions(){return[()=>!0,()=>!0,()=>!0,()=>!0,()=>this.milestones[1]>0]}getTotMult(t){return Math.max(0,t*this.tauFactor*2.203-p(200))}updateMilestones(){let t=0,s=[10,45,80,115,220,500];for(let i=0;i<s.length;i++)Math.max(this.lastPub,this.maxRho)>=s[i]&&(t=i+1);let i=[2,3,1];if(this.lastPub<500&&2===this.stratIndex){let t=0;this.lastPub>45&&(t=4),this.lastPub>80&&(t=8),this.lastPub>115&&(t=20),this.lastPub>220&&(t=40),i=(this.rho+p(.5*t)>this.variables[3].cost||this.rho+p(t)>this.variables[4].cost&&this.milestones[1]>0||this.curMult>1&&this.rho+p(2)>this.variables[1].cost)&&this.rho<Math.min(this.variables[3].cost,this.variables[4].cost)||this.t>this.recursionValue[0]?[1,2,3]:[2,3,1]}this.milestones=[0,0,0];const e=[3,1,2];for(let s=0;s<i.length;s++)for(;this.milestones[i[s]-1]<e[i[s]-1]&&t>0;)this.milestones[i[s]-1]++,t--}updateError(t){if(t<6){let s=[0,p(2.060660172040101),p(12.010407635829813),p(70.00178562229294),p(408.0003059755347),p(2378.000049517553)];return void(this.error=s[t])}let s=Math.SQRT2,i=(Math.pow(-(s-1),t)*(t%2?-1:1)+Math.pow(1+s,t))/2/s,e=Math.pow(s+1,t)*(t%2?-1:1);this.error=p(Math.abs(i))+p(Math.abs(e))}searchCoast(t){if(this.curMult>.7){let i=(s=this.lastPub)<45?Math.pow(s,2.1)/10:s<80?Math.pow(s,2.22)/40:s<220?Math.pow(s,2.7)/33e3+40:s<500?Math.pow(s,2.8)/92e3+40:5*Math.pow(1.5,Math.pow(s,.8475)/20);const e=(this.totMult+Math.log10(4)+Math.log10(200))/2.203*10;if(this.lastPub<500){{let s=b(this.rho,t+this.variables[0].value*(this.maxRho>=10?this.maxRho>=45?this.maxRho>=80?1.15:1.1:1.05:1)+Math.log10(1.5*i)),h=(Math.min(e,s)-this.lastPub)/((this.t+i)/3600);this.bestCoast[0]<h&&(this.bestCoast[0]=h,this.bestCoast[1]=this.t)}i*=.8;{let s=b(this.rho,t+this.variables[0].value*(this.maxRho>=10?this.maxRho>=45?this.maxRho>=80?1.15:1.1:1.05:1)+Math.log10(1.5*i)),h=(Math.min(e,s)-this.lastPub)/((this.t+i)/3600);this.bestCoast[0]<h&&(this.bestCoast[0]=h,this.bestCoast[1]=this.t)}i/=Math.pow(.8,2);{let s=b(this.rho,t+this.variables[0].value*(this.maxRho>=10?this.maxRho>=45?this.maxRho>=80?1.15:1.1:1.05:1)+Math.log10(1.5*i)),h=(Math.min(e,s)-this.lastPub)/((this.t+i)/3600);this.bestCoast[0]<h&&(this.bestCoast[0]=h,this.bestCoast[1]=this.t)}}else{t=this.totMult+this.variables[0].value*(1+.05*this.milestones[0])+this.variables[1].value+this.q;let s=this.totMult+this.variables[2].value+1.15*this.variables[4].value+this.error,h=b(this.q+p(2),s+Math.log10(1.5*i))-p(2),a=b(this.rho,t-this.q+h+Math.log10(1.5*i)),o=(a-this.lastPub)/((this.t+i)/3600);this.bestCoast[0]<o&&a<e&&(this.bestCoast[0]=o,this.bestCoast[1]=this.t)}}var s}simulate(t){return J(this,void 0,void 0,(function*(){if(this.lastPub>=10&&null==t.recursionValue&&2===this.stratIndex){t.recursionValue=[1/0,0];let s=new G(t);yield s.simulate(t),this.recursionValue=[s.bestCoast[1],1]}let s=!1;for(;!s&&tt.simulating;)(this.ticks+1)%5e5==0&&(yield o()),this.tick(),this.rho>this.maxRho&&(this.maxRho=this.rho),this.curMult=Math.pow(10,this.getTotMult(this.maxRho)-this.totMult),(null!=this.recursionValue&&this.t<this.recursionValue[0]||this.curMult<.7||0===this.recursionValue[1])&&this.buyVariables(),this.lastPub<500&&this.updateMilestones(),s=(tt.forcedPubTime!==1/0?this.t>tt.forcedPubTime:this.t>2*this.pubT||this.pubRho>this.cap[0])&&this.pubRho>10,this.ticks++;this.pubMulti=Math.pow(10,this.getTotMult(this.pubRho)-this.totMult);let i=0;for(let t=0;t<this.variables.length;t++){const s=[5,128,16,Math.pow(2,3.346*Math.log2(256)),Math.pow(10,5.65)];i=Math.max(i,this.variables[t].cost-p(s[t]))}let e=M(this,2===this.stratIndex?" "+Math.min(this.pubMulti,Math.pow(10,this.getTotMult(i)-this.totMult)).toFixed(2):"");if(1===this.recursionValue[1]||2!==this.stratIndex){for(;this.boughtVars[this.boughtVars.length-1].timeStamp>this.pubT;)this.boughtVars.pop();tt.varBuy.push([e[7],this.boughtVars])}return e}))}tick(){let t=this.variables[0].value*(1+.05*this.milestones[0]),s=this.milestones[1]>0?this.variables[4].value*(1+.5*this.milestones[2]):0;if(this.updateError_flag){let t=this.milestones[1]>0?this.variables[4].lvl:0,s=this.variables[3].lvl+1+t;this.updateError(s),this.updateError_flag=!1}this.lastPub<500&&this.searchCoast(this.totMult+this.variables[1].value+this.q);let i=this.variables[2].value+s+this.error;this.q=b(this.q,this.totMult+p(this.dt)+i);let e=this.totMult+t+this.variables[1].value+this.q;this.rho=b(this.rho,e+p(this.dt)),this.t+=this.dt/1.5,this.dt*=this.ddt,this.maxRho<this.recovery.value&&(this.recovery.time=this.t),this.tauH=(this.maxRho-this.lastPub)/(this.t/3600),(this.maxTauH<this.tauH||this.maxRho>=this.cap[0]-this.cap[1]||this.pubRho<10||tt.forcedPubTime!==1/0)&&(this.maxTauH=this.tauH,this.pubT=this.t,this.pubRho=this.maxRho)}buyVariables(){let t=!1;for(let s=this.variables.length-1;s>=0;s--)for(;this.rho>this.variables[s].cost&&this.conditions[this.stratIndex][s]()&&this.milestoneConditions[s]();){if(this.maxRho+5>this.lastPub||2!==this.stratIndex){let t=["q1","q2","c1","n","c2"];this.boughtVars.push({variable:t[s],level:this.variables[s].lvl+1,cost:this.variables[s].cost,timeStamp:this.t})}this.rho=d(this.rho,this.variables[s].cost),this.variables[s].buy(),s>2&&(this.updateError_flag=!0),t=!0}t&&this.searchCoast(this.totMult+this.variables[1].value+this.q)}}function Z(t,s,i,e="r"){if("string"==typeof t){const s=t.charAt(t.length-1);if(null!==s.match(/[r/t/m]/))X(t=t.slice(0,-1))&&(t=[t,s]);else{if(!s.match(/[0-9]/))throw`Invalid currency value ${t}. Currency value must be in formats <number>, <exxxx> or <xexxxx>.`;X(t)&&(t=[t,e])}}if("string"==typeof t[0]&&Array.isArray(t)&&(t[0]=K(t[0])),"number"!=typeof t[0])throw`Cannot parse value ${t[0]}. Please contact the author of the sim.`;if("r"===t[1])return t[0];if("t"===t[1])return t[0]/r(s);if("m"===t[1])return function(t,s,i){let e=()=>i<65?0:i<75?1:i<85?2:3,h=(t,h)=>(s-Math.log10(Math.pow(i/20,e()))+Math.log10(h))*(1/t),a=t=>(s-Math.log10(Math.pow(i/20,e())))*(1/t);switch(t){case"T1":return h(.164,3);case"T2":return h(.198,100);case"T3":return o=.147,l=3,(s-Math.log10(Math.pow(i/20,e()))-Math.log10(l))*(1/o);case"T4":return h(.165,4);case"T5":return a(.159);case"T6":return h(.196,50);case"T7":return a(.152);case"T8":return a(.15);case"WSP":case"SL":return s/.15;case"EF":return s*(1/.387)*2.5;case"CSR2":return(s+Math.log10(200))*(1/2.203)*10}var o,l;throw"Failed parsing multiplier. Please contact the author of the sim."}(s,t[0],i);throw`Cannot parse value ${t[0]} and ${t[1]}. Please contact the author of the sim.`}function X(t){if(null===t.match(/^[0-9/e/.]+$/))throw`Invalid currency value ${t}. Currency value must be in formats <number>, <exxxx> or <xexxxx>.`;let s=0;for(let i=0;i<t.length;i++)"e"===t[i]&&s++;if(s>1)throw`Invalid currency value ${t}. Currency value must be in formats <number>, <exxxx> or <xexxxx>.`;let i=0;for(let s=0;s<t.length;s++)"."===t[s]&&i++;if(i>1)throw`Invalid currency value ${t}. Currency value must be in formats <number>, <exxxx> or <xexxxx>.`;return!0}function K(t){return/[e]/.test(t)?u(t):parseFloat(t)}function Q(t){const s=JSON.parse(t),i={sigma:[0,0],ct:!1};let e=0;s[2]=s[2].split(" ");for(let t=0;t<s[2].length;t++)0!==s[2][t].length&&(e<2?i.sigma[e]=Math.max(0,parseInt(s[2][t])):i.ct="y"===s[2][t],e++);const h=[];for(let t=0;t<2;t++){const e=s[t].split(","),a=[];for(let s=0;s<e.length;s++){const h=e[s].split(" "),o=[];for(let e=0;e<h.length;e++)0!==h[e].length&&o.push(Z(h[e],n(s+8*Number(i.ct)),i.sigma[t],"t"));a.push(o)}h.push(a)}return h}function U(){const t=i(".timeDiffInput"),e=s(".timeDiffTable"),h=[];for(const s of t)h.push(s.value);for(Q(JSON.stringify(h));e.firstChild;)e.firstChild.remove();const a=document.createElement("th"),o=document.createElement("td");o.innerHTML="Hello world",a.appendChild(o),e.appendChild(a)}var j=function(t,s,i,e){return new(i||(i=Promise))((function(h,a){function o(t){try{r(e.next(t))}catch(t){a(t)}}function l(t){try{r(e.throw(t))}catch(t){a(t)}}function r(t){var s;t.done?h(t.value):(s=t.value,s instanceof i?s:new i((function(t){t(s)}))).then(o,l)}r((e=e.apply(t,s||[])).next())}))};const Y=s(".output"),tt={dt:1.5,ddt:1.0001,stratFilter:!0,simulating:!1,forcedPubTime:1/0,showA23:!1,varBuy:[[0,[{variable:"var",level:0,cost:0,timeStamp:0}]]],customVal:null},st={lastStrat:null,simEndTimestamp:0};function it(s){return j(this,void 0,void 0,(function*(){if(tt.simulating)return tt.simulating=!1,"Sim stopped.";if((performance.now()-st.simEndTimestamp)/1e3<1)return null;try{let i=function(s){const i={theory:s.theory,strat:s.strat,mode:s.mode,hardCap:s.hardCap,modeInput:s.modeInput,simAllInputs:s.simAllInputs,sigma:0,rho:0,cap:1/0,recovery:null};if("All"!==s.mode&&"Time diff."!==s.mode){if(s.sigma.length>0&&null!==s.sigma.match(/^[0-9]+$/)&&parseInt(s.sigma)>=0&&parseFloat(s.sigma)%1==0)i.sigma=parseInt(s.sigma);else if("T"===s.theory.charAt(0))throw"Invalid sigma value. Sigma must be an integer that's >= 0";if(!(s.rho.length>0))throw"Input value cannot be empty.";if(i.rho=Z(s.rho,i.theory,i.sigma),"Chain"===s.mode||"Steps"===s.mode){if(!(s.cap.length>0))throw"Cap value cannot be empty.";i.cap=Z(s.cap,i.theory,i.sigma)}}return"Single sim"!==s.mode&&"Chain"!==s.mode&&("Time diff."===s.mode&&(s.modeInput=JSON.stringify(s.timeDiffInputs)),i.modeInput=function(s,i){if("Steps"===i&&"string"==typeof s&&X(s))return K(s);if("Amount"===i&&"string"==typeof s){if(null!==s.match(/[0-9]/))return parseFloat(s);throw i+" input must be a number."}if("All"===i)return function(s){let i=s.split(" ");for(let t=0;t<i.length;t++)i[t]=i[t].replace(" ",""),i[t]=i[t].replace("\n","");if(i=i.filter((t=>""!==t)),i.length<2)throw"Student count and at least one theory value that is not 0 is required.";if(i.length-1>t.Jp.length)throw`Invalid value ${i[t.Jp.length+1]} does not match any theory.`;let e=[];if(h=i[0],!/^\d+$/.test(h))throw`Invalid student value ${i[0]}.`;var h;e.push(parseInt(i[0]));for(let t=1;t<i.length;t++)e.push(Z(i[t],n(t-1),e[0],"t"));return e}(s);if("Time diff."===i)return Q(s);if("Time diff."===i||"Single sim"===i||"Chain"===i)return s;throw`Couldnt parse mode ${i}. Please contact the author of the sim.`}(s.modeInput,s.mode)),i}(s),e=[];switch(tt.simulating=!0,i.mode){case"Single sim":e=[yield et(i)];break;case"Chain":e=yield function(t){return j(this,void 0,void 0,(function*(){let s=t.rho,i=0;const e=t.rho,h=[];let a=c(t.cap),l=0;for(;s<t.cap;){let e=performance.now();e-l>250&&(l=e,Y.textContent=`Simulating ${c(s,0)}/${a}`,yield o());let r=yield et(Object.assign({},t));if(!tt.simulating)break;"string"==typeof r[6]&&(st.lastStrat=r[6].split(" ")[0]),h.push(r),s=r[r.length-1][0],t.rho=s,i+=r[r.length-1][1]}st.lastStrat=null,h.push(["","","","","ΔTau Total","","",'Average <span style="font-size:0.9rem; font-style:italics">&tau;</span>/h',"Total Time"]);const n=(t.rho-e)*r(t.theory);return h.push(["","","","",c(n,2),"","",m(n/(i/3600),5),v(i)]),h}))}(i);break;case"Steps":e=yield function(t){return j(this,void 0,void 0,(function*(){let s=0;t.rho;const i=[];let e=c(t.cap),h=0;for(;t.rho<t.cap+1e-5;){let a=performance.now();a-h>250&&(h=a,Y.textContent=`Simulating ${c(t.rho,0)}/${e}`,yield o());let l=yield et(Object.assign({},t));if(!tt.simulating)break;"string"==typeof l[6]&&(st.lastStrat=l[6].split(" ")[0]),i.push(l),t.rho+=t.modeInput,s+=l[l.length-1][1]}return st.lastStrat=null,i}))}(i);break;case"All":e=yield function(t){return j(this,void 0,void 0,(function*(){const s=t.modeInput[0],i=t.modeInput.slice(1,t.modeInput.length);let e=[];for(let a=0;a<i.length;a++){if(0===i[a])continue;if(Y.innerText=`Simulating ${n(a)}/${n(i.length-1)}`,yield o(),!tt.simulating)break;let l=["Best Semi-Idle","Best Overall"];null!=t.simAllInputs&&(l=[t.simAllInputs[0]?"Best Semi-Idle":"Best Idle",t.simAllInputs[1]?"Best Overall":"Best Active"]);let r=[];for(let t=0;t<l.length;t++){let e={theory:n(a),strat:l[t],sigma:s,rho:i[a],cap:1/0,mode:"Single Sim"};r.push(yield et(e))}e.push([(h=r)[0][0],h[0][2],h[1][7],h[0][7],m(h[1][7]/h[0][7],4),h[1][5],h[0][5],h[1][6],h[0][6],h[1][8],h[0][8],h[1][4],h[0][4]])}var h;return e.push([s]),e}))}(i)}return st.simEndTimestamp=performance.now(),e}catch(t){return String(t)}}))}function et(s){var i;return j(this,void 0,void 0,(function*(){if(-1!==a(["Best Overall","Best Active","Best Semi-Idle","Best Idle"],s.strat))return function(s){return j(this,void 0,void 0,(function*(){const i=function(s,i,e){let h=[];switch(s){case"T1":h=[i<25,"Best Overall"!==e&&"Best Active"!==e&&i>=25&&i<850,"Best Overall"!==e&&"Best Active"!==e&&i>625,"Best Semi-Idle"!==e&&"Best Idle"!==e&&("Best Active"===e||i<250),"Best Semi-Idle"!==e&&"Best Idle"!==e&&"Best Active"!==e];break;case"T2":h=["Best Semi-Idle"!==e&&"Best Active"!==e&&"Best Overall"!==e||i<25,"Best Idle"!==e&&("Best Active"!==e&&"Best Overall"!==e||i>=250),"Best Semi-Idle"!==e&&"Best Idle"!==e&&i<250,"Best Active"!==e&&"Best Overall"!==e&&"Best Idle"!==e&&i<250];break;case"T3":h=[i<25,"Best Overall"!==e&&"Best Active"!==e&&i<150,"Best Overall"!==e&&"Best Active"!==e&&"Best Semi-Idle"!==e&&i>=175&&i<300,"Best Overall"!==e&&"Best Active"!==e&&i>=100&&i<175,"Best Overall"!==e&&"Best Active"!==e&&"Best Semi-Idle"!==e&&i>=175&&i<300,"Best Overall"!==e&&"Best Active"!==e&&i>=260&&(i<500||"Best Semi-Idle"!==e),"Best Overall"!==e&&"Best Active"!==e&&"Best Idle"!==e&&i>=150,"Best Overall"!==e&&"Best Idle"!==e&&"Best Semi-Idle"!==e&&i>=275,"Best Semi-Idle"!==e&&"Best Idle"!==e&&i<150,"Best Semi-Idle"!==e&&"Best Idle"!==e&&i>=150&&i<350,"Best Semi-Idle"!==e&&"Best Idle"!==e&&i>=150&&i<350,"Best Semi-Idle"!==e&&"Best Idle"!==e&&i>=150&&i<175,"Best Semi-Idle"!==e&&"Best Idle"!==e&&i>=150&&i<225,"Best Semi-Idle"!==e&&"Best Idle"!==e&&"Best Active"!==e&&i>=200&&i<375,"Best Semi-Idle"!==e&&"Best Idle"!==e&&"Best Active"!==e&&i>=250];break;case"T4":h=[i<30,"Best Overall"!==e&&"Best Active"!==e&&i<600&&"T4C3"!==st.lastStrat,"Best Overall"!==e&&"Best Active"!==e&&i>200,"Best Overall"!==e&&"Best Active"!==e&&i<125,"Best Overall"!==e&&"Best Active"!==e&&i<150,"Best Overall"!==e&&"Best Active"!==e&&i<275,"Best Semi-Idle"!==e&&"Best Idle"!==e&&i<700&&"T4C3d66"!==st.lastStrat&&"T4C123d"!==st.lastStrat,"Best Semi-Idle"!==e&&"Best Idle"!==e&&i<700&&i>175&&("T4C3d66"!==st.lastStrat||i<225),"Best Semi-Idle"!==e&&"Best Idle"!==e&&i>=75&&i<200,"Best Semi-Idle"!==e&&"Best Idle"!==e&&i>=175&&i<300,"Best Semi-Idle"!==e&&"Best Idle"!==e&&i<275,"Best Semi-Idle"!==e&&"Best Idle"!==e&&i>240];break;case"T5":h=[i<25||"Best Overall"!==e&&"Best Active"!==e&&"Best Semi-Idle"!==e,"Best Overall"!==e&&"Best Active"!==e&&"Best Idle"!==e,"Best Idle"!==e&&"Best Semi-Idle"!==e];break;case"T6":h=[i<25,"Best Overall"!==e&&"Best Active"!==e&&i<25,"Best Overall"!==e&&"Best Active"!==e&&i>=25&&i<100,"Best Overall"!==e&&"Best Active"!==e&&i>=100&&i<1100&&"T6noC1234"!==st.lastStrat,"Best Overall"!==e&&"Best Active"!==e&&i>=100&&i<750&&"T6noC34"!==st.lastStrat&&"T6noC1234"!==st.lastStrat,"Best Overall"!==e&&"Best Active"!==e&&i>800,"Best Overall"!==e&&"Best Active"!==e&&"Best Idle"!==e&&i>400,"Best Semi-Idle"!==e&&"Best Idle"!==e&&i<25,"Best Semi-Idle"!==e&&"Best Idle"!==e&&i>=25&&i<100,"Best Semi-Idle"!==e&&"Best Idle"!==e&&"Best Overall"!==e&&i>=100&&i<1100&&"T6noC1234"!==st.lastStrat,"Best Semi-Idle"!==e&&"Best Idle"!==e&&"Best Overall"!==e&&i>=100&&i<750&&"T6noC34"!==st.lastStrat&&"T6noC1234"!==st.lastStrat,"Best Semi-Idle"!==e&&"Best Idle"!==e&&"Best Overall"!==e&&i>800,"Best Semi-Idle"!==e&&"Best Idle"!==e&&"Best Active"!==e&&i>=100];break;case"T7":h=[!1,"Best Overall"!==e&&"Best Active"!==e&&(i<25||i>=75&&i<100),"Best Overall"!==e&&"Best Active"!==e&&i>=25&&i<75,"Best Overall"!==e&&"Best Active"!==e&&i<550&&i>=100,"Best Overall"!==e&&"Best Active"!==e&&i<625&&i>500,"Best Overall"!==e&&"Best Active"!==e&&i>525,"Best Semi-Idle"!==e&&"Best Idle"!==e&&(i<25||i>=75&&i<150),"Best Semi-Idle"!==e&&"Best Idle"!==e&&i>=25&&i<75,"Best Semi-Idle"!==e&&"Best Idle"!==e&&i>=100];break;case"T8":h=["Best Overall"!==e&&"Best Active"!==e&&("Best Semi-Idle"!==e||i<100),"Best Overall"!==e&&"Best Active"!==e&&i<25,"Best Overall"!==e&&"Best Active"!==e&&i>=160&&i<220,"Best Overall"!==e&&"Best Active"!==e&&i>=100&&i<160,"Best Overall"!==e&&"Best Active"!==e&&"Best Idle"!==e,"Best Semi-Idle"!==e&&"Best Idle"!==e&&i<60,"Best Semi-Idle"!==e&&"Best Idle"!==e&&i>=160&&i<220,"Best Semi-Idle"!==e&&"Best Idle"!==e&&i>=100&&i<160,"Best Semi-Idle"!==e&&"Best Idle"!==e&&i>=40&&i<100,"Best Semi-Idle"!==e&&"Best Idle"!==e&&"Best Overall"!==e&&i>=220,"Best Semi-Idle"!==e&&"Best Idle"!==e&&"Best Active"!==e];break;case"WSP":h=["Best Overall"!==e&&"Best Active"!==e&&i<525,"Best Overall"!==e&&"Best Active"!==e&&i>475,"Best Semi-Idle"!==e&&"Best Idle"!==e];break;case"SL":h=[i<25||"Best Idle"===e,"Best Overall"!==e&&"Best Active"!==e&&"Best Idle"!==e&&i>=300,"Best Semi-Idle"!==e&&"Best Idle"!==e&&i>=300,"Best Semi-Idle"!==e&&"Best Idle"!==e&&"Best Overall"!==e&&i<300,"Best Semi-Idle"!==e&&"Best Idle"!==e&&"Best Active"!==e&&i<300];break;case"EF":h=[i<10||"Best Idle"===e,"Best Overall"!==e&&"Best Active"!==e&&"Best Idle"!==e,"Best Semi-Idle"!==e&&"Best Idle"!==e&&i<10,"Best Semi-Idle"!==e&&"Best Idle"!==e];break;case"CSR2":h=[i<10||"Best Idle"===e||"Best Semi-Idle"===e,"Best Active"===e&&i<500,("Best Overall"===e||"Best Active"===e&&i>=500)&&i>10];break;case"RZ":h=[!0,!0,!0,!0]}let a=[];switch(s){case"T1":a=[!0,i>=25,i>=50,!0,!0];break;case"T2":case"EF":case"RZ":a=[!0,!0,!0,!0];break;case"T3":a=[!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0];break;case"T4":a=[!0,!0,!0,i>=25,i>=50,i>=50,!0,!0,i>=25,i>=75,i>=50,!0];break;case"T5":case"WSP":case"CSR2":a=[!0,!0,!0];break;case"T6":a=[!0,!0,!0,!0,!0,i>=125,!0,!0,!0,!0,!0,i>=125,!0];break;case"T7":a=[!0,!0,i>=25,i>=25,i>=75,i>=75,!0,i>=25,i>=100];break;case"T8":a=[!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0];break;case"SL":a=[!0,!0,!0,!0,!0]}if(0===h.length)throw"No strats found";let o=[];for(let i=0;i<h.length;i++)!h[i]&&tt.stratFilter||!a[i]||o.push(t.S3[l(s)][i]);return o}(s.theory,s.rho,s.strat);let e=new Array(9).fill(0);for(let t=0;t<i.length;t++){s.strat=i[t];let h=yield et(s);e[7]<h[7]&&(e=h)}return e}))}(s);const e={strat:s.strat,strats:t.S3[l(s.theory)],sigma:s.sigma,rho:s.rho,recursionValue:null,recovery:null!==(i=s.recovery)&&void 0!==i?i:{value:0,time:0,recoveryTime:!1},cap:s.hardCap?s.cap:null};switch(s.theory){case"T1":return yield function(t){return y(this,void 0,void 0,(function*(){let s=new x(t);return yield s.simulate()}))}(e);case"T2":return yield function(t){return C(this,void 0,void 0,(function*(){let s=new B(t);return yield s.simulate()}))}(e);case"T3":return yield function(t){return P(this,void 0,void 0,(function*(){let s=new S(t);return yield s.simulate()}))}(e);case"T4":return yield function(t){return R(this,void 0,void 0,(function*(){let s=new I(t);return yield s.simulate(t)}))}(e);case"T5":return yield function(t){return V(this,void 0,void 0,(function*(){let s=new A(t);return yield s.simulate()}))}(e);case"T6":return yield function(t){return H(this,void 0,void 0,(function*(){let s=new k(t);return yield s.simulate()}))}(e);case"T7":return yield function(t){return q(this,void 0,void 0,(function*(){let s=new O(t);return yield s.simulate()}))}(e);case"T8":return yield function(t){return L(this,void 0,void 0,(function*(){let s=new F(t);return yield s.simulate()}))}(e);case"WSP":return yield function(t){return E(this,void 0,void 0,(function*(){let s=new D(t);return yield s.simulate()}))}(e);case"SL":return yield function(t){return $(this,void 0,void 0,(function*(){let s=new _(t);return yield s.simulate()}))}(e);case"EF":return yield z(e);case"CSR2":return yield function(t){return J(this,void 0,void 0,(function*(){let s=new G(t);return yield s.simulate(t)}))}(e)}throw`Theory ${s.theory} is not defined in singleSim() function. Please contact the author of the sim.`}))}const ht=s(".theory"),at=s(".strat"),ot=(s(".sigma"),s(".input"),s(".cap")),lt=s(".mode"),rt=s("textarea"),nt=s(".hardCap"),ut=s(".semi-idle"),ct=s(".hard-active"),vt=i(".timeDiffInput"),mt=s(".extraInputs"),bt=s(".timeDiffWrapper"),dt=i(".controls")[0],pt=s(".simAllInputs"),ft=s(".extraInputDescription");function Mt(){dt.style.display="none",mt.style.display="none",bt.style.display="none",nt.style.display="none",pt.style.display="none",ft.style.display="inline",rt.style.height="1.8em",rt.style.width="6rem",ot.style.display="none",s(".capDesc").style.display="none","Chain"!==lt.value&&"Steps"!==lt.value||(ot.style.display="inline",s(".capDesc").style.display="inline"),"Single sim"!==lt.value&&"Time diff."!==lt.value&&"Chain"!==lt.value&&(mt.style.display="flex"),"Time diff."===lt.value&&(bt.style.display="grid"),"All"!==lt.value&&"Time diff."!==lt.value&&(dt.style.display="grid"),"All"===lt.value&&(pt.style.display="grid",ft.style.display="none",rt.style.height="3rem",rt.style.width="20rem"),rt.placeholder=t.CN[a(t.Sw,lt.value)],ft.textContent=t.xy[a(t.Sw,lt.value)]}function gt(){for(;at.firstChild;)at.firstChild.remove();const s=["Best Overall","Best Active","Best Semi-Idle","Best Idle"];for(let t=0;t<4;t++){const i=e("option");i.value=s[t],i.textContent=s[t],at.appendChild(i)}const i=a(t.Jp,ht.value);for(let s=0;s<t.S3[i].length;s++){const h=e("option");h.value=t.S3[i][s],h.textContent=t.S3[i][s],at.appendChild(h)}}window.onload=()=>{var s;for(let s=0;s<t.Jp.length;s++){const i=e("option");i.value=t.Jp[s],i.textContent=t.Jp[s],ht.appendChild(i)}for(let s=0;s<t.S3[0].length;s++){const i=e("option");i.value=t.S3[0][s],i.textContent=t.S3[0][s],at.appendChild(i)}for(let s=0;s<t.Sw.length;s++){const i=e("option");i.value=t.Sw[s],i.textContent=t.Sw[s],lt.appendChild(i)}Mt(),h(lt,"input",Mt),h(ht,"change",gt);const i=JSON.parse(null!==(s=localStorage.getItem("simAllSettings"))&&void 0!==s?s:"[true, false]");ut.checked=i[0],ct.checked=i[1];for(const t of vt)h(t,"input",(()=>{U()}))};const wt=s(".theory"),Tt=s(".strat"),yt=s(".sigma"),xt=s(".input"),Ct=s(".cap"),Bt=s(".mode"),Pt=s("textarea"),St=s(".hardCap"),Rt=s(".output"),It=s(".simTable"),Vt=s(".dtOtp"),At=s(".ddtOtp"),Ht=s(".a23");const kt=s(".theory"),qt=s(".strat"),Ot=s(".sigma"),Lt=s(".input"),Ft=s(".cap"),Et=s(".mode"),Dt=s("textarea"),$t=i(".timeDiffInput"),_t=s(".hardCap"),Nt=s(".semi-idle"),zt=s(".hard-active"),Wt=s(".output");let Jt=s(".simTable"),Gt=s(".simTable > thead"),Zt=s(".simTable > tbody");const Xt=s(".simulate"),Kt=s(".dtOtp"),Qt=s(".ddtOtp"),Ut=s(".a23");let jt="All";const Yt='<span style="font-size:0.9rem; font-style:italics">&tau;</span>',ts={current:"All",single:`<th style="padding-inline: 0.5rem !important">Theory</th><th><span style="font-size:0.9rem;">&sigma;</span><sub>t</sub></th><th>Last Pub</th><th>Max Rho</th><th>&Delta;${Yt}</th><th>Multi</th><th>Strat</th><th>${Yt}/h</th><th>Pub Time</th>`,all:`<th>&emsp;</th><th>Input</th><th>${Yt}/h Active</th><th>${Yt}/h Idle</th><th>Ratio</th><th>Multi Active</th><th>Multi Idle</th><th>Strat Active</th><th>Strat Idle</th><th>Time Active</th><th>Time Idle</th><th>&Delta;${Yt} Active</th><th>&Delta;${Yt} Idle</th>`};function ss(t){document.body.style.overflow="hidden",s(".boughtVars").showModal();const i=s(".boughtVarsOtp");for(;i.firstChild;)i.firstChild.remove();for(let s=0;s<t.length;s++){const e=document.createElement("tr"),h=document.createElement("td");h.innerText=t[s].variable,e.appendChild(h);const a=document.createElement("td");a.innerText=t[s].level.toString(),e.appendChild(a);const o=document.createElement("td");o.innerText=c(t[s].cost,2),e.appendChild(o);const l=document.createElement("td");l.innerText=v(t[s].timeStamp),e.appendChild(l),i.appendChild(e)}}function is(){for(;Zt.firstChild;)Zt.firstChild.remove()}Gt.innerHTML=ts.all,Jt.classList.add("big"),"true"===localStorage.getItem("autoSave")&&setTimeout((()=>function(){var t;const i=JSON.parse(null!==(t=localStorage.getItem("simState"))&&void 0!==t?t:'{"controls1":{"theory":{"value":"T1","innerHTML":"<option value=\\"T1\\">T1</option><option value=\\"T2\\">T2</option><option value=\\"T3\\">T3</option><option value=\\"T4\\">T4</option><option value=\\"T5\\">T5</option><option value=\\"T6\\">T6</option><option value=\\"T7\\">T7</option><option value=\\"T8\\">T8</option><option value=\\"WSP\\">WSP</option><option value=\\"SL\\">SL</option><option value=\\"EF\\">EF</option><option value=\\"CSR2\\">CSR2</option><option value=\\"PD\\">PD</option><option value=\\"FI\\">FI</option>"},"strat":{"value":"Best Overall","innerHTML":"\\n            <option value=\\"Best Overall\\">Best Overall</option>\\n            <option value=\\"Best Active\\">Best Active</option>\\n            <option value=\\"Best Semi-Idle\\">Best Semi-Idle</option>\\n            <option value=\\"Best Idle\\">Best Idle</option>\\n          <option value=\\"T1\\">T1</option><option value=\\"T1C34\\">T1C34</option><option value=\\"T1C4\\">T1C4</option><option value=\\"T1Ratio\\">T1Ratio</option><option value=\\"T1SolarXLII\\">T1SolarXLII</option>"},"sigma":"","input":"","cap":false},"controls2":{"mode":"All","modeInput":"","extraInputDescription":"","hardCap":"on","timeDiffInputs":["","",""]},"output":"","table":"\\n<thead><tr><th> </th><th>Input</th><th>τ/h Active</th><th>τ/h Idle</th><th>Ratio</th><th>Multi Active</th><th>Multi Idle</th><th>Strat Active</th><th>Strat Idle</th><th>Time Active</th><th>Time Idle</th><th>Δτ Active</th><th>Δτ Idle</th></tr></thead>\\n        <tbody></tbody>\\n      ","settings":{"dt":"1.5","ddt":"1.0001"}}');wt.innerHTML=i.controls1.theory.innerHTML,wt.value=i.controls1.theory.value,Tt.innerHTML=i.controls1.strat.innerHTML,Tt.value=i.controls1.strat.value,yt.value=i.controls1.sigma,xt.value=i.controls1.input,Ct.value=i.controls1.cap,Bt.value=i.controls2.mode,Pt.value=i.controls2.modeInput,s(".extraInputDescription").textContent=i.controls2.extraInputDescription,St.checked=i.controls2.hardCap,s(".timeDiffWrapper").children[0].value=i.controls2.timeDiffInputs[0],s(".timeDiffWrapper").children[1].value=i.controls2.timeDiffInputs[1],s(".timeDiffWrapper").children[2].value=i.controls2.timeDiffInputs[2],Rt.textContent=i.output,It.innerHTML=i.table,Vt.textContent=i.settings.dt,At.textContent=i.settings.ddt,Ht.checked=i.settings.showA23,s(".dt").value="8.1943",s(".ddt").value="2.71233",Mt(),It.classList.remove("big"),It.classList.remove("small"),"All"!==i.controls2.mode?It.classList.add("small"):It.classList.add("big")}()),500),h(Xt,"click",(()=>{return t=void 0,i=void 0,a=function*(){var t,i;tt.dt=parseFloat(null!==(t=Kt.textContent)&&void 0!==t?t:"1.5"),tt.ddt=parseFloat(null!==(i=Qt.textContent)&&void 0!==i?i:"1.0001"),tt.stratFilter=!0,tt.showA23=Ut.checked,localStorage.setItem("simAllSettings",JSON.stringify([Nt.checked,zt.checked]));const h={theory:kt.value,strat:qt.value,sigma:Ot.value.replace(" ",""),rho:Lt.value.replace(" ",""),cap:Ft.value.replace(" ",""),mode:Et.value,modeInput:Dt.value,simAllInputs:[Nt.checked,zt.checked],timeDiffInputs:[],hardCap:_t.checked};for(let t of $t)h.timeDiffInputs.push(t.value);Wt.textContent="",Xt.textContent="Stop simulating",yield o();let a=yield it(h);Wt.textContent="string"==typeof a?a:"",null!==a&&"string"!=typeof a&&function(t){jt!==Et.value&&is(),jt=Et.value,Jt=s(".simTable"),Gt=s(".simTable > thead"),Zt=s(".simTable > tbody"),"All"===Et.value?(Jt.classList.add("big"),Jt.classList.remove("small"),Gt.innerHTML=ts.all,Gt.children[0].children[0].innerHTML=t[t.length-1][0].toString()+'<span style="font-size:0.9rem;">&sigma;</span><sub>t</sub>',t.pop()):(Jt.classList.remove("big"),Jt.classList.add("small"),Gt.innerHTML=ts.single),(Zt.children.length>1&&(t.length>1||""===Zt.children[Zt.children.length-1].children[0].innerHTML)||"All"===Et.value)&&is();for(let s=0;s<t.length;s++){const i=e("tr");for(let h=0;h<Gt.children[0].children.length;h++){const a=e("td");a.innerHTML=String(t[s][h]),i.appendChild(a)}Zt.appendChild(i)}!function(){Zt=s(".simTable > tbody");for(let t=0;t<tt.varBuy.length;t++)for(let s=0;s<(null==Zt?void 0:Zt.children.length);s++){const i=null==Zt?void 0:Zt.children[s];if(parseFloat(null==i?void 0:i.children[7].innerHTML)===parseFloat(tt.varBuy[t][0])){let s=tt.varBuy[t][1];(null==i?void 0:i.children[8]).onclick=()=>{ss(s)},(null==i?void 0:i.children[8]).style.cursor="pointer"}}tt.varBuy=[]}()}(a),Xt.textContent="Simulate",tt.simulating=!1,localStorage.setItem("simState",JSON.stringify({controls1:{theory:{value:wt.value,innerHTML:wt.innerHTML},strat:{value:Tt.value,innerHTML:Tt.innerHTML},sigma:yt.value,input:xt.value,cap:Ct.value},controls2:{mode:Bt.value,modeInput:Pt.value,extraInputDescription:s(".extraInputDescription").textContent,hardCap:St.checked,timeDiffInputs:[s(".timeDiffWrapper").children[0].value,s(".timeDiffWrapper").children[1].value,s(".timeDiffWrapper").children[2].value]},output:Rt.textContent,table:It.innerHTML,settings:{dt:Vt.textContent,ddt:At.textContent,showA23:Ht.checked}}))},new((h=void 0)||(h=Promise))((function(s,e){function o(t){try{r(a.next(t))}catch(t){e(t)}}function l(t){try{r(a.throw(t))}catch(t){e(t)}}function r(t){var i;t.done?s(t.value):(i=t.value,i instanceof h?i:new h((function(t){t(i)}))).then(o,l)}r((a=a.apply(t,i||[])).next())}));var t,i,h,a})),h(s(".boughtVarsCloseBtn"),"pointerdown",(()=>{s(".boughtVars").close(),document.body.style.overflow="auto"}))})();